
;; Function strlcat (strlcat, funcdef_no=22, decl_uid=3480, cgraph_uid=23, symbol_order=23)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8
;; 2 succs { 3 4 }
;; 3 succs { 8 }
;; 4 succs { 5 6 }
;; 5 succs { 7 }
;; 6 succs { 7 }
;; 7 succs { 8 }
;; 8 succs { 1 }
size_t strlcat (char * restrict dst, const char * restrict src, size_t maxlen)
{
  const size_t dstlen;
  const size_t srclen;
  size_t D.3552;

  <bb 2> :
  srclen = strlen (src);
  dstlen = strnlen (dst, maxlen);
  if (dstlen == maxlen)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  D.3552 = maxlen + srclen;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 8>; [INV]

  <bb 4> :
  _1 = maxlen - dstlen;
  if (srclen < _1)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  _2 = srclen + 1;
  _3 = dst + dstlen;
  memcpy (_3, src, _2);
  goto <bb 7>; [INV]

  <bb 6> :
  _4 = maxlen + 18446744073709551615;
  _5 = dst + dstlen;
  memcpy (_5, src, _4);
  _6 = dstlen + maxlen;
  _7 = _6 + 18446744073709551615;
  _8 = dst + _7;
  *_8 = 0;

  <bb 7> :
  D.3552 = dstlen + srclen;

  <bb 8> :
  return D.3552;

}



;; Function tilde_expand_filename (tilde_expand_filename, funcdef_no=23, decl_uid=3490, cgraph_uid=24, symbol_order=24)

Merging blocks 13 and 14
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11 12 13
;; 2 succs { 3 4 }
;; 3 succs { 13 }
;; 4 succs { 5 8 }
;; 5 succs { 6 7 }
;; 6 succs { }
;; 7 succs { 8 }
;; 8 succs { 9 10 }
;; 9 succs { 10 }
;; 10 succs { 11 12 }
;; 11 succs { }
;; 12 succs { 13 }
;; 13 succs { 1 }
char * tilde_expand_filename (const char * filename, uid_t uid)
{
  u_int slash;
  u_int len;
  struct passwd * pw;
  char ret[64];
  char user[128];
  const char * path;
  char * D.3559;

  <bb 2> :
  _1 = *filename;
  if (_1 != 126)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  D.3559 = strdup (filename);
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 13>; [INV]

  <bb 4> :
  filename = filename + 1;
  path = strchr (filename, 47);
  _2 = path != 0B;
  _3 = path > filename;
  _4 = _2 & _3;
  if (_4 != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 5> :
  _5 = path - filename;
  slash = (u_int) _5;
  if (slash > 127)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  printf ("tilde_expand_filename: ~username too long%s\n", "");
  exit (1);

  <bb 7> :
  _6 = (long unsigned int) slash;
  memcpy (&user, filename, _6);
  user[slash] = 0;

  <bb 8> :
  if (path != 0B)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  filename = path + 1;

  <bb 10> :
  _7 = strlcat (&ret, filename, 64);
  if (_7 > 63)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  printf ("tilde_expand_filename: Path too long%s\n", "");
  exit (1);

  <bb 12> :
  D.3559 = strdup (&ret);

  <bb 13> :
  user = {CLOBBER};
  ret = {CLOBBER};
  return D.3559;

}



;; Function read_keyfile_line (read_keyfile_line, funcdef_no=24, decl_uid=3507, cgraph_uid=25, symbol_order=25)

;; 2 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7
;;
;; Loop 1
;;  header 5, latch 3
;;  depth 1, outer 0
;;  nodes: 5 3
;; 2 succs { 5 }
;; 3 succs { 4 5 }
;; 4 succs { 7 }
;; 5 succs { 3 6 }
;; 6 succs { 7 }
;; 7 succs { 1 }
int read_keyfile_line (struct FILE * f, const char * filename, char * buf, size_t bufsz, u_long * lineno)
{
  static const char __func__[18] = "read_keyfile_line";
  int D.3572;

  <bb 2> :
  goto <bb 5>; [INV]

  <bb 3> :
  _1 = *lineno;
  _2 = _1 + 1;
  *lineno = _2;
  _3 = *lineno;
  printf ("%s: %s line %lu exceeds size limit\n", &__func__, filename, _3);
  _4 = rand ();
  _5 = _4 % 2;
  if (_5 == 1)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  D.3572 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 7>; [INV]

  <bb 5> :
  _6 = rand ();
  _7 = _6 % 2;
  if (_7 == 1)
    goto <bb 3>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 6> :
  D.3572 = -1;

  <bb 7> :
  return D.3572;

}



;; Function main (main, funcdef_no=26, decl_uid=3538, cgraph_uid=27, symbol_order=27)

Removing basic block 7
Merging blocks 5 and 6
Merging blocks 5 and 8
;; 2 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5
;;
;; Loop 1
;;  header 4, latch 3
;;  depth 1, outer 0
;;  nodes: 4 3
;; 2 succs { 4 }
;; 3 succs { 4 }
;; 4 succs { 3 5 }
;; 5 succs { 1 }
int main (int argc, char * * argv)
{
  int i;
  int updating;
  struct passwd pw;
  int D.3574;

  <bb 2> :
  _1 = time (0B);
  _2 = (unsigned int) _1;
  srand (_2);
  i = 0;
  goto <bb 4>; [INV]

  <bb 3> :
  _3 = (long unsigned int) i;
  _4 = _3 * 8;
  _5 = argv + _4;
  _6 = *_5;
  update_krl_from_file (&pw, _6);
  i = i + 1;

  <bb 4> :
  if (i < argc)
    goto <bb 3>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 5> :
  D.3574 = 0;
  pw = {CLOBBER};
  return D.3574;

}



;; Function update_krl_from_file (update_krl_from_file, funcdef_no=25, decl_uid=3515, cgraph_uid=26, symbol_order=26)

Removing basic block 8
;; 2 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11 12 13
;;
;; Loop 1
;;  header 10, latch 8
;;  depth 1, outer 0
;;  nodes: 10 8
;; 2 succs { 3 4 }
;; 3 succs { 6 }
;; 4 succs { 5 6 }
;; 5 succs { }
;; 6 succs { 7 10 }
;; 7 succs { 10 }
;; 8 succs { 9 10 }
;; 9 succs { }
;; 10 succs { 8 11 }
;; 11 succs { 12 13 }
;; 12 succs { 13 }
;; 13 succs { 1 }
void update_krl_from_file (struct passwd * pw, const char * file)
{
  struct FILE * krl_spec;
  int r;
  int was_sha1;
  int was_explicit_key;
  int i;
  long long unsigned int serial2;
  long long unsigned int serial;
  char line[16384];
  char * ep;
  char * cp;
  char * path;
  u_long lnum;
  struct Key * key;

  <bb 2> :
  key = 0B;
  lnum = 0;
  _1 = pw->pw_uid;
  _2 = (unsigned int) _1;
  path = tilde_expand_filename (file, _2);
  _3 = strcmp (path, "-");
  if (_3 == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  krl_spec = stdin;
  free (path);
  path = strdup ("(standard input)");
  goto <bb 6>; [INV]

  <bb 4> :
  krl_spec = fopen (path, "r");
  if (krl_spec == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  printf ("fopen %s: \n", path);
  exit (1);

  <bb 6> :
  quiet.0_4 = quiet;
  if (quiet.0_4 == 0)
    goto <bb 7>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 7> :
  printf ("Revoking from %s\n", path);
  goto <bb 10>; [INV]

  <bb 8> :
  _5 = rand ();
  _6 = _5 % 2;
  if (_6 == 1)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  printf ("%s: invalid\n", path);
  exit (1);

  <bb 10> :
  _7 = read_keyfile_line (krl_spec, path, &line, 16384, &lnum);
  if (_7 == 0)
    goto <bb 8>; [INV]
  else
    goto <bb 11>; [INV]

  <bb 11> :
  _8 = strcmp (path, "-");
  if (_8 != 0)
    goto <bb 12>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 12> :
  fclose (krl_spec);

  <bb 13> :
  lnum = {CLOBBER};
  line = {CLOBBER};
  return;

}


