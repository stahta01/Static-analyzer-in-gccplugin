
;; Function SSL_free (SSL_free, funcdef_no=22, decl_uid=3551, cgraph_uid=23, symbol_order=22)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5
;; 2 succs { 3 4 }
;; 3 succs { 5 }
;; 4 succs { 5 }
;; 5 succs { 1 }
void SSL_free (struct SSL * s)
{
  <bb 2> :
  if (s == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 5>; [INV]

  <bb 4> :
  _1 = s->ext.tls13_cookie;
  free (_1);
  free (s);

  <bb 5> :
  return;

}



;; Function PACKET_memdup (PACKET_memdup, funcdef_no=23, decl_uid=3556, cgraph_uid=24, symbol_order=23)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7
;; 2 succs { 3 4 }
;; 3 succs { 7 }
;; 4 succs { 5 6 }
;; 5 succs { 7 }
;; 6 succs { 7 }
;; 7 succs { 1 }
int PACKET_memdup (const struct PACKET * pkt, unsigned char * * data, size_t * len)
{
  size_t length;
  int D.3601;

  <bb 2> :
  _1 = *data;
  free (_1);
  *data = 0B;
  *len = 0;
  _2 = PACKET_remaining (pkt);
  length = (size_t) _2;
  if (length == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  D.3601 = 1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 7>; [INV]

  <bb 4> :
  _3 = pkt->curr;
  _4 = strdup (_3);
  *data = _4;
  _5 = *data;
  if (_5 == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  D.3601 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 7>; [INV]

  <bb 6> :
  *len = length;
  D.3601 = 1;

  <bb 7> :
  return D.3601;

}



;; Function tls_parse_stoc_cookie (tls_parse_stoc_cookie, funcdef_no=24, decl_uid=3568, cgraph_uid=25, symbol_order=24)

Merging blocks 6 and 7
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6
;; 2 succs { 4 3 }
;; 3 succs { 4 5 }
;; 4 succs { 6 }
;; 5 succs { 6 }
;; 6 succs { 1 }
int tls_parse_stoc_cookie (struct SSL * s, struct PACKET * pkt, unsigned int context, struct X509 * x, size_t chainidx, int * al)
{
  struct PACKET cookie;
  int D.3608;

  <bb 2> :
  _1 = PACKET_as_length_prefixed_2 (pkt, &cookie);
  if (_1 == 0)
    goto <bb 4>; [INV]
  else
    goto <bb 3>; [INV]

  <bb 3> :
  _2 = &s->ext.tls13_cookie_len;
  _3 = &s->ext.tls13_cookie;
  _4 = PACKET_memdup (&cookie, _3, _2);
  if (_4 == 0)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  D.3608 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 6>; [INV]

  <bb 5> :
  D.3608 = 1;

  <bb 6> :
  cookie = {CLOBBER};
  return D.3608;

}



;; Function tls_construct_ctos_cookie (tls_construct_ctos_cookie, funcdef_no=25, decl_uid=3579, cgraph_uid=26, symbol_order=25)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11
;; 2 succs { 3 4 }
;; 3 succs { 11 }
;; 4 succs { 8 5 }
;; 5 succs { 8 6 }
;; 6 succs { 8 7 }
;; 7 succs { 8 9 }
;; 8 succs { 10 }
;; 9 succs { 10 }
;; 10 succs { 11 }
;; 11 succs { 1 }
int tls_construct_ctos_cookie (struct SSL * s, WPACKET * pkt, unsigned int context, struct X509 * x, size_t chainidx, int * al)
{
  int ret;
  int D.3613;

  <bb 2> :
  ret = 0;
  _1 = s->ext.tls13_cookie_len;
  if (_1 == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  D.3613 = 1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 4> :
  _2 = WPACKET_put_bytes_u16 (pkt, 0);
  if (_2 == 0)
    goto <bb 8>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 5> :
  _3 = WPACKET_start_sub_packet_u16 (pkt);
  if (_3 == 0)
    goto <bb 8>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 6> :
  _4 = s->ext.tls13_cookie_len;
  _5 = s->ext.tls13_cookie;
  _6 = WPACKET_sub_memcpy_u16 (pkt, _5, _4);
  if (_6 == 0)
    goto <bb 8>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 7> :
  _7 = WPACKET_close (pkt);
  if (_7 == 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  // predicted unlikely by goto predictor.
  goto <bb 10>; [INV]

  <bb 9> :
  ret = 1;

  <bb 10> :
end:
  _8 = s->ext.tls13_cookie;
  free (_8);
  s->ext.tls13_cookie_len = 0;
  D.3613 = ret;

  <bb 11> :
  return D.3613;

}



;; Function main (main, funcdef_no=26, decl_uid=3591, cgraph_uid=27, symbol_order=26)

Removing basic block 4
Merging blocks 2 and 3
Merging blocks 2 and 5
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2
;; 2 succs { 1 }
int main ()
{
  struct SSL * s;
  struct PACKET pkt;
  int D.3620;

  <bb 2> :
  s = malloc (16);
  s->ext.tls13_cookie = 0B;
  s->ext.tls13_cookie_len = 0;
  pkt.curr = "PACKET";
  tls_parse_stoc_cookie (s, &pkt, 0, 0B, 0, 0B);
  tls_construct_ctos_cookie (s, 0B, 0, 0B, 0, 0B);
  SSL_free (s);
  D.3620 = 0;
  pkt = {CLOBBER};
  return D.3620;

}


