
;; Function ssl3_new (ssl3_new, funcdef_no=22, decl_uid=3551, cgraph_uid=23, symbol_order=22)

Merging blocks 3 and 5
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5
;; 2 succs { 3 4 }
;; 3 succs { 5 }
;; 4 succs { 5 }
;; 5 succs { 1 }
int ssl3_new (struct SSL * s)
{
  struct SSL3_STATE * s3;
  int D.3586;

  <bb 2> :
  s3 = malloc (16);
  if (s3 == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  // predicted unlikely by goto predictor.
  D.3586 = 0;
  goto <bb 5>; [INV]

  <bb 4> :
  s->s3 = s3;
  D.3586 = 1;

  <bb 5> :
  return D.3586;

}



;; Function ssl3_free (ssl3_free, funcdef_no=23, decl_uid=3556, cgraph_uid=24, symbol_order=23)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6
;; 2 succs { 4 3 }
;; 3 succs { 4 5 }
;; 4 succs { 6 }
;; 5 succs { 6 }
;; 6 succs { 1 }
void ssl3_free (struct SSL * s)
{
  <bb 2> :
  if (s == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 3>; [INV]

  <bb 3> :
  _1 = s->s3;
  if (_1 == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 6>; [INV]

  <bb 5> :
  _2 = s->s3;
  _3 = _2->tmp.pms;
  free (_3);
  _4 = s->s3;
  free (_4);
  s->s3 = 0B;

  <bb 6> :
  return;

}



;; Function tls_construct_client_key_exchange (tls_construct_client_key_exchange, funcdef_no=25, decl_uid=3574, cgraph_uid=26, symbol_order=25)

Merging blocks 3 and 5
Merging blocks 6 and 7
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5
;; 2 succs { 3 4 }
;; 3 succs { 5 }
;; 4 succs { 5 }
;; 5 succs { 1 }
int tls_construct_client_key_exchange (struct SSL * s, WPACKET * pkt)
{
  int al;
  long unsigned int alg_k;
  int D.3594;

  <bb 2> :
  al = -1;
  _1 = tls_construct_cke_rsa (s, pkt, &al);
  if (_1 == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  // predicted unlikely by goto predictor.
  _2 = s->s3;
  _3 = _2->tmp.pms;
  free (_3);
  _4 = s->s3;
  _4->tmp.pms = 0B;
  D.3594 = 0;
  goto <bb 5>; [INV]

  <bb 4> :
  D.3594 = 1;

  <bb 5> :
  al = {CLOBBER};
  return D.3594;

}



;; Function tls_construct_cke_rsa (tls_construct_cke_rsa, funcdef_no=24, decl_uid=3561, cgraph_uid=25, symbol_order=24)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10
;; 2 succs { 3 4 }
;; 3 succs { 10 }
;; 4 succs { 5 6 }
;; 5 succs { 9 }
;; 6 succs { 7 8 }
;; 7 succs { 9 }
;; 8 succs { 10 }
;; 9 succs { 10 }
;; 10 succs { 1 }
int tls_construct_cke_rsa (struct SSL * s, WPACKET * pkt, int * al)
{
  size_t pmslen;
  unsigned char * pms;
  size_t enclen;
  unsigned char * encdata;
  int D.3599;

  <bb 2> :
  encdata = 0B;
  pms = 0B;
  pmslen = 0;
  pmslen = 48;
  pms = malloc (pmslen);
  if (pms == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  D.3599 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 10>; [INV]

  <bb 4> :
  _1 = s->client_version;
  _2 = _1 >> 8;
  _3 = (unsigned char) _2;
  *pms = _3;
  _4 = s->client_version;
  _5 = pms + 1;
  _6 = (unsigned char) _4;
  *_5 = _6;
  _7 = (unsigned int) pmslen;
  _8 = _7 + 4294967294;
  _9 = (int) _8;
  _10 = pms + 2;
  _11 = RAND_bytes (_10, _9);
  if (_11 <= 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  // predicted unlikely by goto predictor.
  goto <bb 9>; [INV]

  <bb 6> :
  _12 = s->s3;
  _12->tmp.pms = pms;
  _13 = s->s3;
  _13->tmp.pmslen = pmslen;
  _14 = ssl_log_rsa_client_key_exchange (s, encdata, enclen, pms, pmslen);
  if (_14 == 0)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  // predicted unlikely by goto predictor.
  goto <bb 9>; [INV]

  <bb 8> :
  D.3599 = 1;
  goto <bb 10>; [INV]

  <bb 9> :
err:
  _15 = s->s3;
  _16 = _15->tmp.pms;
  free (_16);
  D.3599 = 0;

  <bb 10> :
  return D.3599;

}



;; Function main (main, funcdef_no=26, decl_uid=3579, cgraph_uid=27, symbol_order=26)

Removing basic block 9
Merging blocks 8 and 10
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8
;; 2 succs { 3 4 }
;; 3 succs { 8 }
;; 4 succs { 5 6 }
;; 5 succs { 7 }
;; 6 succs { 7 }
;; 7 succs { 8 }
;; 8 succs { 1 }
int main ()
{
  struct SSL s;
  int D.3607;

  <bb 2> :
  _1 = ssl3_new (&s);
  if (_1 == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  D.3607 = 1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 8>; [INV]

  <bb 4> :
  _2 = tls_construct_client_key_exchange (&s, 0B);
  if (_2 == 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  // predicted unlikely by goto predictor.
  goto <bb 7>; [INV]

  <bb 6> :
  _3 = s.s3;
  _4 = _3->tmp.pms;
  printf ("%d\n", _4);

  <bb 7> :
end:
  ssl3_free (&s);
  D.3607 = 0;

  <bb 8> :
  s = {CLOBBER};
  return D.3607;

}


