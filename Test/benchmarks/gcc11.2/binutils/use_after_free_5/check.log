./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c: In function ‘savestring’:
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:21:3: warning: implicit declaration of function ‘memcpy’ [-Wimplicit-function-declaration]
   21 |   memcpy (p, ptr, len);
      |   ^~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:8:1: note: include ‘<string.h>’ or provide a declaration of ‘memcpy’
    7 | #include "../include/binutils.h"
  +++ |+#include <string.h>
    8 | 
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:21:3: warning: incompatible implicit declaration of built-in function ‘memcpy’ [-Wbuiltin-declaration-mismatch]
   21 |   memcpy (p, ptr, len);
      |   ^~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:21:3: note: include ‘<string.h>’ or provide a declaration of ‘memcpy’
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c: In function ‘strip_bg_char’:
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:37:14: warning: implicit declaration of function ‘strlen’ [-Wimplicit-function-declaration]
   37 |   p = args + strlen (args);
      |              ^~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:37:14: note: include ‘<string.h>’ or provide a declaration of ‘strlen’
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:37:14: warning: incompatible implicit declaration of built-in function ‘strlen’ [-Wbuiltin-declaration-mismatch]
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:37:14: note: include ‘<string.h>’ or provide a declaration of ‘strlen’
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:41:26: warning: implicit declaration of function ‘isspace’ [-Wimplicit-function-declaration]
   41 |       while (p > args && isspace (p[-1]))
      |                          ^~~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:8:1: note: include ‘<ctype.h>’ or provide a declaration of ‘isspace’
    7 | #include "../include/binutils.h"
  +++ |+#include <ctype.h>
    8 | 
In file included from ./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:6:
./benchmarks/binutils/use_after_free_5/../include/common.h:22:20: warning: implicit declaration of function ‘strdup’ [-Wimplicit-function-declaration]
   22 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:52:10: note: in expansion of macro ‘xstrdup’
   52 |   return xstrdup (args);        /* allocation site */
      |          ^~~~~~~
./benchmarks/binutils/use_after_free_5/../include/common.h:22:20: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
   22 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:52:10: note: in expansion of macro ‘xstrdup’
   52 |   return xstrdup (args);        /* allocation site */
      |          ^~~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c: In function ‘attach_command’:
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:68:19: warning: implicit declaration of function ‘find_attach_target’ [-Wimplicit-function-declaration]
   68 |   attach_target = find_attach_target ();
      |                   ^~~~~~~~~~~~~~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:68:17: warning: assignment to ‘struct target_ops *’ from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
   68 |   attach_target = find_attach_target ();
      |                 ^
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:79:7: warning: implicit declaration of function ‘target_can_async_p’ [-Wimplicit-function-declaration]
   79 |   if (target_can_async_p ())
      |       ^~~~~~~~~~~~~~~~~~
In file included from ./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:6:
./benchmarks/binutils/use_after_free_5/../include/common.h:22:20: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
   22 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:85:21: note: in expansion of macro ‘xstrdup’
   85 |           a->args = xstrdup (args);     /* use-after-free */
      |                     ^~~~~~~
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:91:3: warning: implicit declaration of function ‘attach_command_post_wait’ [-Wimplicit-function-declaration]
   91 |   attach_command_post_wait (args, from_tty, async_exec);
      |   ^~~~~~~~~~~~~~~~~~~~~~~~

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  1298k ( 49%)
 phase parsing                      :   0.04 ( 80%)   0.00 (  0%)   0.04 ( 80%)  1119k ( 43%)
 phase opt and generate             :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 20%)   205k (  8%)
 callgraph ipa passes               :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 20%)   118k (  5%)
 lto stream compression             :   0.01 ( 20%)   0.00 (  0%)   0.00 (  0%)     0  (  0%)
 preprocessing                      :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 20%)   365k ( 14%)
 lexical analysis                   :   0.01 ( 20%)   0.00 (  0%)   0.02 ( 40%)     0  (  0%)
 parser (global)                    :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 20%)   595k ( 23%)
 parser function body               :   0.01 ( 20%)   0.00 (  0%)   0.00 (  0%)    78k (  3%)
 branch prediction                  :   0.00 (  0%)   0.00 (  0%)   0.01 ( 20%)    10k (  0%)
 TOTAL                              :   0.05          0.00          0.05         2633k
./benchmarks/binutils/use_after_free_5/../include/common.h: In function ‘savestring’:
./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:21:3: warning: use of possibly-NULL ‘p_6’ where non-null expected [CWE-690] [-Wanalyzer-possible-null-argument]
   21 |   memcpy (p, ptr, len);
      |   ^
  ‘attach_command’: events 1-2
    |
    |   56 | attach_command (char *args, int from_tty)
    |      | ^
    |      | |
    |      | (1) entry to ‘attach_command’
    |......
    |   65 |   args = strip_bg_char (args, &async_exec);
    |      |          ~
    |      |          |
    |      |          (2) calling ‘strip_bg_char’ from ‘attach_command’
    |
    +--> ‘strip_bg_char’: events 3-10
           |
           |   27 | strip_bg_char (const char *args, int *bg_char_p)
           |      | ^
           |      | |
           |      | (3) entry to ‘strip_bg_char’
           |......
           |   31 |   if (args == NULL || *args == '\0')
           |      |      ~
           |      |      |
           |      |      (4) following ‘false’ branch...
           |......
           |   37 |   p = args + strlen (args);
           |      |              ~
           |      |              |
           |      |              (5) ...to here
           |   38 |   if (p[-1] == '&')
           |      |      ~
           |      |      |
           |      |      (6) following ‘true’ branch...
           |   39 |     {
           |   40 |       p--;
           |      |        ~
           |      |        |
           |      |        (7) ...to here
           |......
           |   45 |       if (p != args)
           |      |          ~
           |      |          |
           |      |          (8) following ‘true’ branch (when ‘p_9 != args_12(D)’)...
           |   46 |         return savestring (args, p - args);
           |      |                ~                   ~
           |      |                |                   |
           |      |                |                   (9) ...to here
           |      |                (10) calling ‘savestring’ from ‘strip_bg_char’
           |
           +--> ‘savestring’: events 11-13
                  |
                  |   17 | savestring (const char *ptr, size_t len)
                  |      | ^
                  |      | |
                  |      | (11) entry to ‘savestring’
                  |   18 | {
                  |   19 |   char *p = (char *) xmalloc (len + 1); /* allocation site */
                  |      |                      ~
                  |      |                      |
                  |      |                      (12) this call could return NULL
                  |   20 | 
                  |   21 |   memcpy (p, ptr, len);
                  |      |   ~
                  |      |   |
                  |      |   (13) argument 1 (‘p_6’) from (12) could be NULL where non-null expected
                  |
<built-in>: note: argument 1 of ‘memcpy’ must be non-null
./benchmarks/binutils/use_after_free_5/../include/common.h: In function ‘make_my_cleanup2’:
./benchmarks/binutils/use_after_free_5/../include/common.h:129:13: warning: dereference of possibly-NULL ‘new_4’ [CWE-690] [-Wanalyzer-possible-null-dereference]
  129 |   new->next = *pmy_chain;
      |             ^
  ‘attach_command’: events 1-2
    |
    |./benchmarks/binutils/use_after_free_5/binutils_uaf_5.c:56:1:
    |   56 | attach_command (char *args, int from_tty)
    |      | ^
    |      | |
    |      | (1) entry to ‘attach_command’
    |......
    |   66 |   args_chain = make_cleanup (free, args);
    |      |                ~
    |      |                |
    |      |                (2) calling ‘make_cleanup’ from ‘attach_command’
    |
    +--> ‘make_cleanup’: events 3-4
           |
           |./benchmarks/binutils/use_after_free_5/../include/common.h:149:1:
           |  149 | make_cleanup (make_cleanup_ftype *function, void *arg)
           |      | ^
           |      | |
           |      | (3) entry to ‘make_cleanup’
           |  150 | {
           |  151 |   return make_my_cleanup (&cleanup_chain, function, arg);
           |      |          ~
           |      |          |
           |      |          (4) calling ‘make_my_cleanup’ from ‘make_cleanup’
           |
           +--> ‘make_my_cleanup’: events 5-6
                  |
                  |  142 | make_my_cleanup (struct cleanup **pmy_chain, make_cleanup_ftype *function,
                  |      | ^
                  |      | |
                  |      | (5) entry to ‘make_my_cleanup’
                  |......
                  |  145 |   return make_my_cleanup2 (pmy_chain, function, arg, NULL);
                  |      |          ~
                  |      |          |
                  |      |          (6) calling ‘make_my_cleanup2’ from ‘make_my_cleanup’
                  |
                  +--> ‘make_my_cleanup2’: events 7-9
                         |
                         |  122 | make_my_cleanup2 (struct cleanup **pmy_chain, make_cleanup_ftype *function,
                         |      | ^
                         |      | |
                         |      | (7) entry to ‘make_my_cleanup2’
                         |......
                         |  126 |     = (struct cleanup *) malloc (sizeof (struct cleanup));
                         |      |                          ~
                         |      |                          |
                         |      |                          (8) this call could return NULL
                         |......
                         |  129 |   new->next = *pmy_chain;
                         |      |             ~
                         |      |             |
                         |      |             (9) ‘new_4’ could be NULL: unchecked value from (8)
                         |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)  2157k ( 93%)
 phase opt and generate             :   0.11 (100%)   0.01 (100%)   0.12 ( 92%)   113k (  5%)
 ipa lto gimple in                  :   0.01 (  9%)   0.00 (  0%)   0.00 (  0%)    88k (  4%)
 ipa reference                      :   0.01 (  9%)   0.00 (  0%)   0.01 (  8%)     0  (  0%)
 analyzer: processing worklist      :   0.05 ( 45%)   0.00 (  0%)   0.07 ( 54%)   448  (  0%)
 analyzer: emitting diagnostics     :   0.04 ( 36%)   0.01 (100%)   0.03 ( 23%)     0  (  0%)
 analyzer: shortest paths           :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)     0  (  0%)
 TOTAL                              :   0.11          0.01          0.13         2328k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)  2157k ( 76%)
 phase opt and generate             :   0.03 (100%)   0.00 (  0%)   0.03 ( 75%)   628k ( 22%)
 callgraph functions expansion      :   0.03 (100%)   0.00 (  0%)   0.03 ( 75%)   524k ( 18%)
 cfg cleanup                        :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)   216  (  0%)
 expand                             :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)    50k (  2%)
 integrated RA                      :   0.01 ( 33%)   0.00 (  0%)   0.00 (  0%)   220k (  8%)
 reload CSE regs                    :   0.01 ( 33%)   0.00 (  0%)   0.00 (  0%)  2072  (  0%)
 initialize rtl                     :   0.01 ( 33%)   0.00 (  0%)   0.01 ( 25%)    12k (  0%)
 TOTAL                              :   0.03          0.00          0.04         2833k
/usr/bin/ld: /tmp/ccDgbuuN.ltrans0.ltrans.o: in function `attach_command':
<artificial>:(.text+0x1ed): undefined reference to `find_attach_target'
/usr/bin/ld: <artificial>:(.text+0x1ff): undefined reference to `target_can_async_p'
/usr/bin/ld: <artificial>:(.text+0x21b): undefined reference to `attach_command_post_wait'
collect2: error: ld returned 1 exit status
