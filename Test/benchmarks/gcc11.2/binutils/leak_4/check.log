./benchmarks/binutils/leak_4/binutils_leak_4.c: In function ‘main’:
./benchmarks/binutils/leak_4/binutils_leak_4.c:190:15: warning: implicit declaration of function ‘time’ [-Wimplicit-function-declaration]
  190 |         srand(time(&t));
      |               ^~~~

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  1298k ( 51%)
 phase parsing                      :   0.02 ( 67%)   0.01 ( 50%)   0.04 ( 67%)  1015k ( 40%)
 phase opt and generate             :   0.01 ( 33%)   0.01 ( 50%)   0.02 ( 33%)   240k (  9%)
 callgraph optimization             :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)     0  (  0%)
 callgraph ipa passes               :   0.01 ( 33%)   0.01 ( 50%)   0.02 ( 33%)   134k (  5%)
 lto stream output                  :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)     0  (  0%)
 preprocessing                      :   0.01 ( 33%)   0.00 (  0%)   0.02 ( 33%)   290k ( 11%)
 lexical analysis                   :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)     0  (  0%)
 parser (global)                    :   0.01 ( 33%)   0.00 (  0%)   0.00 (  0%)   590k ( 23%)
 parser function body               :   0.00 (  0%)   0.01 ( 50%)   0.01 ( 17%)    85k (  3%)
 dominance computation              :   0.01 ( 33%)   0.01 ( 50%)   0.00 (  0%)     0  (  0%)
 TOTAL                              :   0.03          0.02          0.06         2564k
./benchmarks/binutils/leak_4/../include/common.h: In function ‘decode_line_info’:
./benchmarks/binutils/leak_4/binutils_leak_4.c:185:1: warning: leak of ‘table_26’ [CWE-401] [-Wanalyzer-malloc-leak]
  185 | }
      | ^
  ‘decode_line_info’: events 1-13
    |
    |  147 |         table = (struct line_info_table *) malloc (amt);
    |      |                                            ^
    |      |                                            |
    |      |                                            (1) allocated here
    |  148 |         if (table == NULL)
    |      |            ~                                
    |      |            |
    |      |            (2) assuming ‘table_26’ is non-NULL
    |      |            (3) following ‘false’ branch (when ‘table_26’ is non-NULL)...
    |......
    |  151 |         table->num_files = 0;
    |      |                          ~                  
    |      |                          |
    |      |                          (4) ...to here
    |......
    |  155 |         while (line < 5)
    |      |                     ~                       
    |      |                     |
    |      |                     (5) following ‘true’ branch (when ‘line_16 <= 4’)...
    |  156 |                 {
    |  157 |                         line++;
    |      |                             ~               
    |      |                             |
    |      |                             (6) ...to here
    |......
    |  160 |                         if (!add_line_info(table, line, end_sequence))
    |      |                            ~                
    |      |                            |
    |      |                            (7) following ‘true’ branch...
    |  161 |                                 goto fail;
    |      |                                 ~           
    |      |                                 |
    |      |                                 (8) ...to here
    |......
    |  180 |                 if (table->sequences != NULL)
    |      |                    ~                        
    |      |                    |
    |      |                    (9) following ‘false’ branch...
    |......
    |  183 |                 if (table->files != NULL)
    |      |                    ~     ~                  
    |      |                    |     |
    |      |                    |     (10) ...to here
    |      |                    (11) following ‘false’ branch...
    |  184 |                         free (table->files);
    |  185 | }
    |      | ~                                           
    |      | |
    |      | (12) ...to here
    |      | (13) ‘table_26’ leaks here; was allocated at (1)
    |
./benchmarks/binutils/leak_4/binutils_leak_4.c:185:1: warning: leak of ‘<unknown>’ [CWE-401] [-Wanalyzer-malloc-leak]
  185 | }
      | ^
  ‘decode_line_info’: events 1-6
    |
    |  138 | static struct line_info_table* decode_line_info (void)
    |      |                                ^
    |      |                                |
    |      |                                (1) entry to ‘decode_line_info’
    |......
    |  148 |         if (table == NULL)
    |      |            ~                    
    |      |            |
    |      |            (2) following ‘false’ branch (when ‘table_26’ is non-NULL)...
    |......
    |  151 |         table->num_files = 0;
    |      |                          ~      
    |      |                          |
    |      |                          (3) ...to here
    |......
    |  155 |         while (line < 5)
    |      |                     ~           
    |      |                     |
    |      |                     (4) following ‘true’ branch (when ‘line_16 <= 4’)...
    |  156 |                 {
    |  157 |                         line++;
    |      |                             ~   
    |      |                             |
    |      |                             (5) ...to here
    |......
    |  160 |                         if (!add_line_info(table, line, end_sequence))
    |      |                              ~  
    |      |                              |
    |      |                              (6) calling ‘add_line_info’ from ‘decode_line_info’
    |
    +--> ‘add_line_info’: events 7-17
           |
           |   43 | add_line_info (struct line_info_table *table,
           |      | ^
           |      | |
           |      | (7) entry to ‘add_line_info’
           |......
           |   49 |         struct line_info* info = (struct line_info *) malloc (amt);
           |      |                                                       ~
           |      |                                                       |
           |      |                                                       (8) allocated here
           |   50 | 
           |   51 |         if (info == NULL)
           |      |            ~
           |      |            |
           |      |            (9) assuming ‘info_27’ is non-NULL
           |      |            (10) following ‘false’ branch (when ‘info_27’ is non-NULL)...
           |......
           |   54 |         info->prev_line = NULL;
           |      |                         ~
           |      |                         |
           |      |                         (11) ...to here
           |......
           |   60 |         if (seq
           |      |            ~
           |      |            |
           |      |            (12) following ‘false’ branch (when ‘seq_25’ is NULL)...
           |......
           |   69 |         else if (!seq || seq->last_line->end_sequence)
           |      |                 ~
           |      |                 |
           |      |                 (13) ...to here
           |      |                 (14) following ‘true’ branch (when ‘seq_25’ is NULL)...
           |......
           |   73 |                         seq = (struct line_sequence *) malloc (amt);    /* allocation site */
           |      |                                                        ~
           |      |                                                        |
           |      |                                                        (15) ...to here
           |   74 |                         if (seq == NULL)
           |      |                            ~
           |      |                            |
           |      |                            (16) following ‘false’ branch (when ‘seq_40’ is non-NULL)...
           |......
           |   77 |                         seq->prev_sequence = table->sequences;
           |      |                                                   ~
           |      |                                                   |
           |      |                                                   (17) ...to here
           |
    <------+
    |
  ‘decode_line_info’: events 18-25
    |
    |  160 |                         if (!add_line_info(table, line, end_sequence))
    |      |                            ~ ^
    |      |                            | |
    |      |                            | (18) returning to ‘decode_line_info’ from ‘add_line_info’
    |      |                            (19) following ‘true’ branch...
    |  161 |                                 goto fail;
    |      |                                 ~
    |      |                                 |
    |      |                                 (20) ...to here
    |......
    |  180 |                 if (table->sequences != NULL)
    |      |                    ~          
    |      |                    |
    |      |                    (21) following ‘true’ branch...
    |  181 |                         free (table->sequences);
    |      |                                    ~
    |      |                                    |
    |      |                                    (22) ...to here
    |  182 | 
    |  183 |                 if (table->files != NULL)
    |      |                    ~          
    |      |                    |
    |      |                    (23) following ‘false’ branch...
    |  184 |                         free (table->files);
    |  185 | }
    |      | ~                             
    |      | |
    |      | (24) ...to here
    |      | (25) ‘<unknown>’ leaks here; was allocated at (8)
    |
./benchmarks/binutils/leak_4/../include/common.h: In function ‘add_line_info’:
./benchmarks/binutils/leak_4/binutils_leak_4.c:67:40: warning: leak of ‘<unknown>’ [CWE-401] [-Wanalyzer-malloc-leak]
   67 |                         seq->last_line = info;
      |                                        ^
  ‘decode_line_info’: events 1-6
    |
    |  138 | static struct line_info_table* decode_line_info (void)
    |      |                                ^
    |      |                                |
    |      |                                (1) entry to ‘decode_line_info’
    |......
    |  148 |         if (table == NULL)
    |      |            ~                    
    |      |            |
    |      |            (2) following ‘false’ branch (when ‘table_26’ is non-NULL)...
    |......
    |  151 |         table->num_files = 0;
    |      |                          ~      
    |      |                          |
    |      |                          (3) ...to here
    |......
    |  155 |         while (line < 5)
    |      |                     ~           
    |      |                     |
    |      |                     (4) following ‘true’ branch (when ‘line_16 <= 4’)...
    |  156 |                 {
    |  157 |                         line++;
    |      |                             ~   
    |      |                             |
    |      |                             (5) ...to here
    |......
    |  160 |                         if (!add_line_info(table, line, end_sequence))
    |      |                              ~  
    |      |                              |
    |      |                              (6) calling ‘add_line_info’ from ‘decode_line_info’
    |
    +--> ‘add_line_info’: events 7-17
           |
           |   43 | add_line_info (struct line_info_table *table,
           |      | ^
           |      | |
           |      | (7) entry to ‘add_line_info’
           |......
           |   49 |         struct line_info* info = (struct line_info *) malloc (amt);
           |      |                                                       ~
           |      |                                                       |
           |      |                                                       (8) allocated here
           |   50 | 
           |   51 |         if (info == NULL)
           |      |            ~
           |      |            |
           |      |            (9) assuming ‘info_27’ is non-NULL
           |      |            (10) following ‘false’ branch (when ‘info_27’ is non-NULL)...
           |......
           |   54 |         info->prev_line = NULL;
           |      |                         ~
           |      |                         |
           |      |                         (11) ...to here
           |......
           |   60 |         if (seq
           |      |            ~
           |      |            |
           |      |            (12) following ‘false’ branch (when ‘seq_25’ is NULL)...
           |......
           |   69 |         else if (!seq || seq->last_line->end_sequence)
           |      |                 ~
           |      |                 |
           |      |                 (13) ...to here
           |      |                 (14) following ‘true’ branch (when ‘seq_25’ is NULL)...
           |......
           |   73 |                         seq = (struct line_sequence *) malloc (amt);    /* allocation site */
           |      |                                                        ~
           |      |                                                        |
           |      |                                                        (15) ...to here
           |   74 |                         if (seq == NULL)
           |      |                            ~
           |      |                            |
           |      |                            (16) following ‘false’ branch (when ‘seq_40’ is non-NULL)...
           |......
           |   77 |                         seq->prev_sequence = table->sequences;
           |      |                                                   ~
           |      |                                                   |
           |      |                                                   (17) ...to here
           |
    <------+
    |
  ‘decode_line_info’: events 18-23
    |
    |  160 |                         if (!add_line_info(table, line, end_sequence))
    |      |                            ~ ^
    |      |                            | |
    |      |                            | (18) returning to ‘decode_line_info’ from ‘add_line_info’
    |      |                            (19) following ‘false’ branch...
    |......
    |  163 |                         if ((table->num_files % FILE_ALLOC_CHUNK) == 0)
    |      |                            ~      ~
    |      |                            |      |
    |      |                            |      (20) ...to here
    |      |                            (21) following ‘true’ branch...
    |......
    |  166 |                                         amt = table->num_files + FILE_ALLOC_CHUNK;
    |      |                                                    ~
    |      |                                                    |
    |      |                                                    (22) ...to here
    |......
    |  170 |                                         if (tmp == NULL)
    |      |                                            ~
    |      |                                            |
    |      |                                            (23) following ‘false’ branch (when ‘tmp_39’ is non-NULL)...
    |
  ‘decode_line_info’: event 24
    |
    |lto1:
    | (24): ...to here
    |
  ‘decode_line_info’: events 25-27
    |
    |  155 |         while (line < 5)
    |      |                     ^
    |      |                     |
    |      |                     (25) following ‘true’ branch (when ‘line_16 <= 4’)...
    |  156 |                 {
    |  157 |                         line++;
    |      |                             ~
    |      |                             |
    |      |                             (26) ...to here
    |......
    |  160 |                         if (!add_line_info(table, line, end_sequence))
    |      |                              ~
    |      |                              |
    |      |                              (27) calling ‘add_line_info’ from ‘decode_line_info’
    |
    +--> ‘add_line_info’: events 28-37
           |
           |   43 | add_line_info (struct line_info_table *table,
           |      | ^
           |      | |
           |      | (28) entry to ‘add_line_info’
           |......
           |   51 |         if (info == NULL)
           |      |            ~
           |      |            |
           |      |            (29) following ‘false’ branch (when ‘info_27’ is non-NULL)...
           |......
           |   54 |         info->prev_line = NULL;
           |      |                         ~
           |      |                         |
           |      |                         (30) ...to here
           |......
           |   60 |         if (seq
           |      |            ~
           |      |            |
           |      |            (31) following ‘true’ branch (when ‘seq_25’ is non-NULL)...
           |   61 |                         && seq->last_line->end_sequence == end_sequence)
           |      |                         ~     ~
           |      |                         |     |
           |      |                         |     (32) ...to here
           |      |                         (33) following ‘true’ branch...
           |   62 |                 {
           |   63 |                         if (table->lcl_head == seq->last_line)
           |      |                            ~     ~
           |      |                            |     |
           |      |                            |     (34) ...to here
           |      |                            (35) following ‘true’ branch...
           |   64 |                                 table->lcl_head = info;
           |      |                                                 ~
           |      |                                                 |
           |      |                                                 (36) ...to here
           |......
           |   67 |                         seq->last_line = info;
           |      |                                        ~
           |      |                                        |
           |      |                                        (37) ‘<unknown>’ leaks here; was allocated at (8)
           |
./benchmarks/binutils/leak_4/binutils_leak_4.c:74:28: warning: leak of ‘info_27’ [CWE-401] [-Wanalyzer-malloc-leak]
   74 |                         if (seq == NULL)
      |                            ^
  ‘add_line_info’: events 1-5
    |
    |   49 |         struct line_info* info = (struct line_info *) malloc (amt);
    |      |                                                       ^
    |      |                                                       |
    |      |                                                       (1) allocated here
    |   50 | 
    |   51 |         if (info == NULL)
    |      |            ~                                           
    |      |            |
    |      |            (2) assuming ‘info_27’ is non-NULL
    |      |            (3) following ‘false’ branch (when ‘info_27’ is non-NULL)...
    |......
    |   54 |         info->prev_line = NULL;
    |      |                         ~                              
    |      |                         |
    |      |                         (4) ...to here
    |......
    |   74 |                         if (seq == NULL)
    |      |                            ~                           
    |      |                            |
    |      |                            (5) following ‘true’ branch (when ‘seq_40’ is NULL)...
    |
  ‘add_line_info’: event 6
    |
    |lto1:
    | (6): ...to here
    |
  ‘add_line_info’: event 7
    |
    |   74 |                         if (seq == NULL)
    |      |                            ^
    |      |                            |
    |      |                            (7) ‘info_27’ leaks here; was allocated at (1)
    |
./benchmarks/binutils/leak_4/../include/common.h: In function ‘make_my_cleanup2’:
./benchmarks/binutils/leak_4/../include/common.h:129:13: warning: dereference of possibly-NULL ‘new_4’ [CWE-690] [-Wanalyzer-possible-null-dereference]
  129 |   new->next = *pmy_chain;
      |             ^
  ‘make_my_cleanup2’: events 1-2
    |
    |  126 |     = (struct cleanup *) malloc (sizeof (struct cleanup));
    |      |                          ^
    |      |                          |
    |      |                          (1) this call could return NULL
    |......
    |  129 |   new->next = *pmy_chain;
    |      |             ~             
    |      |             |
    |      |             (2) ‘new_4’ could be NULL: unchecked value from (1)
    |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 (  3%)  2157k ( 91%)
 phase opt and generate             :   0.27 (100%)   0.01 (100%)   0.28 ( 97%)   149k (  6%)
 ipa reference                      :   0.01 (  4%)   0.00 (  0%)   0.01 (  3%)     0  (  0%)
 analyzer                           :   0.00 (  0%)   0.00 (  0%)   0.01 (  3%)     0  (  0%)
 analyzer: processing worklist      :   0.11 ( 41%)   0.00 (  0%)   0.12 ( 41%)   720  (  0%)
 analyzer: emitting diagnostics     :   0.14 ( 52%)   0.01 (100%)   0.13 ( 45%)     0  (  0%)
 analyzer: shortest paths           :   0.01 (  4%)   0.00 (  0%)   0.01 (  3%)     0  (  0%)
 TOTAL                              :   0.27          0.01          0.29         2368k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 81%)
 phase opt and generate             :   0.03 (100%)   0.01 (100%)   0.04 (100%)   467k ( 18%)
 callgraph functions expansion      :   0.03 (100%)   0.01 (100%)   0.04 (100%)   369k ( 14%)
 tree CCP                           :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)   504  (  0%)
 dominance computation              :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)     0  (  0%)
 integrated RA                      :   0.01 ( 33%)   0.00 (  0%)   0.01 ( 25%)    99k (  4%)
 LRA non-specific                   :   0.01 ( 33%)   0.01 (100%)   0.00 (  0%)  1376  (  0%)
 initialize rtl                     :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)    12k (  0%)
 rest of compilation                :   0.01 ( 33%)   0.00 (  0%)   0.00 (  0%)    12k (  0%)
 TOTAL                              :   0.03          0.01          0.04         2662k
