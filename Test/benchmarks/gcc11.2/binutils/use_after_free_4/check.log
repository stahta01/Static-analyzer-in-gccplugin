./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c: In function ‘svr4_read_so_list’:
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:73:22: warning: implicit declaration of function ‘lm_info_read’ [-Wimplicit-function-declaration]
   73 |       new->lm_info = lm_info_read (lm);
      |                      ^~~~~~~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:73:20: warning: assignment to ‘struct lm_info *’ from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
   73 |       new->lm_info = lm_info_read (lm);
      |                    ^
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:84:11: warning: implicit declaration of function ‘warning’ [-Wimplicit-function-declaration]
   84 |           warning (_("Corrupted shared library list: %s != %s"),
      |           ^~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:84:20: warning: implicit declaration of function ‘_’ [-Wimplicit-function-declaration]
   84 |           warning (_("Corrupted shared library list: %s != %s"),
      |                    ^
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:85:20: warning: implicit declaration of function ‘paddress’ [-Wimplicit-function-declaration]
   85 |                    paddress (target_gdbarch (), prev_lm),
      |                    ^~~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:85:30: warning: implicit declaration of function ‘target_gdbarch’ [-Wimplicit-function-declaration]
   85 |                    paddress (target_gdbarch (), prev_lm),
      |                              ^~~~~~~~~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:98:36: warning: implicit declaration of function ‘get_svr4_info’ [-Wimplicit-function-declaration]
   98 |           struct svr4_info *info = get_svr4_info ();
      |                                    ^~~~~~~~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:98:36: warning: initialization of ‘struct svr4_info *’ from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:107:7: warning: implicit declaration of function ‘target_read_string’ [-Wimplicit-function-declaration]
  107 |       target_read_string (new->lm_info->l_name, &buffer,
      |       ^~~~~~~~~~~~~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:118:22: warning: implicit declaration of function ‘safe_strerror’ [-Wimplicit-function-declaration]
  118 |                      safe_strerror (errcode));
      |                      ^~~~~~~~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:123:7: warning: implicit declaration of function ‘strncpy’ [-Wimplicit-function-declaration]
  123 |       strncpy (new->so_name, buffer, SO_NAME_MAX_PATH_SIZE - 1);
      |       ^~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:8:1: note: include ‘<string.h>’ or provide a declaration of ‘strncpy’
    7 | #include "../include/binutils.h"
  +++ |+#include <string.h>
    8 | 
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:123:7: warning: incompatible implicit declaration of built-in function ‘strncpy’ [-Wbuiltin-declaration-mismatch]
  123 |       strncpy (new->so_name, buffer, SO_NAME_MAX_PATH_SIZE - 1);
      |       ^~~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:123:7: note: include ‘<string.h>’ or provide a declaration of ‘strncpy’
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:125:7: warning: implicit declaration of function ‘strcpy’ [-Wimplicit-function-declaration]
  125 |       strcpy (new->so_original_name, new->so_name);
      |       ^~~~~~
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:125:7: note: include ‘<string.h>’ or provide a declaration of ‘strcpy’
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:125:7: warning: incompatible implicit declaration of built-in function ‘strcpy’ [-Wbuiltin-declaration-mismatch]
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:125:7: note: include ‘<string.h>’ or provide a declaration of ‘strcpy’
./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:130:32: warning: implicit declaration of function ‘match_main’ [-Wimplicit-function-declaration]
  130 |       if (! new->so_name[0] || match_main (new->so_name))
      |                                ^~~~~~~~~~

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  1298k ( 48%)
 phase parsing                      :   0.02 (100%)   0.02 ( 67%)   0.04 ( 67%)  1141k ( 42%)
 phase opt and generate             :   0.00 (  0%)   0.01 ( 33%)   0.02 ( 33%)   237k (  9%)
 dump files                         :   0.00 (  0%)   0.01 ( 33%)   0.00 (  0%)     0  (  0%)
 callgraph ipa passes               :   0.00 (  0%)   0.01 ( 33%)   0.02 ( 33%)   135k (  5%)
 ipa lto decl out                   :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)   768  (  0%)
 ipa free lang data                 :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)  2968  (  0%)
 preprocessing                      :   0.00 (  0%)   0.00 (  0%)   0.02 ( 33%)   368k ( 14%)
 lexical analysis                   :   0.01 ( 50%)   0.00 (  0%)   0.01 ( 17%)     0  (  0%)
 parser (global)                    :   0.00 (  0%)   0.01 ( 33%)   0.01 ( 17%)   597k ( 22%)
 parser enumerator list             :   0.00 (  0%)   0.01 ( 33%)   0.00 (  0%)    27k (  1%)
 parser function body               :   0.01 ( 50%)   0.00 (  0%)   0.00 (  0%)    87k (  3%)
 TOTAL                              :   0.02          0.03          0.06         2688k
./benchmarks/binutils/use_after_free_4/../include/common.h: In function ‘make_my_cleanup2’:
./benchmarks/binutils/use_after_free_4/../include/common.h:129:13: warning: dereference of possibly-NULL ‘new_4’ [CWE-690] [-Wanalyzer-possible-null-dereference]
  129 |   new->next = *pmy_chain;
      |             ^
  ‘main’: events 1-2
    |
    |./benchmarks/binutils/use_after_free_4/binutils_uaf_4.c:145:5:
    |  145 | int main(int argc, char **argv)
    |      |     ^
    |      |     |
    |      |     (1) entry to ‘main’
    |......
    |  148 |         svr4_read_so_list(argc, argc - 1, &link_ptr, 1);
    |      |         ~
    |      |         |
    |      |         (2) calling ‘svr4_read_so_list’ from ‘main’
    |
    +--> ‘svr4_read_so_list’: events 3-6
           |
           |   57 | svr4_read_so_list (CORE_ADDR lm, CORE_ADDR prev_lm,
           |      | ^
           |      | |
           |      | (3) entry to ‘svr4_read_so_list’
           |......
           |   63 |   for (; lm != 0; prev_lm = lm, lm = next_lm)
           |      |             ~
           |      |             |
           |      |             (4) following ‘true’ branch (when ‘lm_41 != 0’)...
           |......
           |   70 |       new = XCNEW (struct so_list);             /* allocation site */
           |      |             ~
           |      |             |
           |      |             (5) ...to here
           |   71 |       old_chain = make_cleanup_free_so (new);
           |      |                   ~
           |      |                   |
           |      |                   (6) calling ‘make_cleanup_free_so’ from ‘svr4_read_so_list’
           |
           +--> ‘make_cleanup_free_so’: events 7-8
                  |
                  |   51 | make_cleanup_free_so (struct so_list *so)
                  |      | ^
                  |      | |
                  |      | (7) entry to ‘make_cleanup_free_so’
                  |   52 | {
                  |   53 |   return make_cleanup (do_free_so, so);
                  |      |          ~
                  |      |          |
                  |      |          (8) calling ‘make_cleanup’ from ‘make_cleanup_free_so’
                  |
                  +--> ‘make_cleanup’: events 9-10
                         |
                         |./benchmarks/binutils/use_after_free_4/../include/common.h:149:1:
                         |  149 | make_cleanup (make_cleanup_ftype *function, void *arg)
                         |      | ^
                         |      | |
                         |      | (9) entry to ‘make_cleanup’
                         |  150 | {
                         |  151 |   return make_my_cleanup (&cleanup_chain, function, arg);
                         |      |          ~
                         |      |          |
                         |      |          (10) calling ‘make_my_cleanup’ from ‘make_cleanup’
                         |
                         +--> ‘make_my_cleanup’: events 11-12
                                |
                                |  142 | make_my_cleanup (struct cleanup **pmy_chain, make_cleanup_ftype *function,
                                |      | ^
                                |      | |
                                |      | (11) entry to ‘make_my_cleanup’
                                |......
                                |  145 |   return make_my_cleanup2 (pmy_chain, function, arg, NULL);
                                |      |          ~
                                |      |          |
                                |      |          (12) calling ‘make_my_cleanup2’ from ‘make_my_cleanup’
                                |
                                +--> ‘make_my_cleanup2’: events 13-15
                                       |
                                       |  122 | make_my_cleanup2 (struct cleanup **pmy_chain, make_cleanup_ftype *function,
                                       |      | ^
                                       |      | |
                                       |      | (13) entry to ‘make_my_cleanup2’
                                       |......
                                       |  126 |     = (struct cleanup *) malloc (sizeof (struct cleanup));
                                       |      |                          ~
                                       |      |                          |
                                       |      |                          (14) this call could return NULL
                                       |......
                                       |  129 |   new->next = *pmy_chain;
                                       |      |             ~
                                       |      |             |
                                       |      |             (15) ‘new_4’ could be NULL: unchecked value from (14)
                                       |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)  2157k ( 90%)
 phase opt and generate             :   0.12 (100%)   0.00 (  0%)   0.12 ( 92%)   153k (  6%)
 ipa dead code removal              :   0.01 (  8%)   0.00 (  0%)   0.00 (  0%)     0  (  0%)
 ipa reference                      :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)     0  (  0%)
 analyzer                           :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)     0  (  0%)
 analyzer: processing worklist      :   0.10 ( 83%)   0.00 (  0%)   0.10 ( 77%)   576  (  0%)
 analyzer: emitting diagnostics     :   0.01 (  8%)   0.00 (  0%)   0.00 (  0%)     0  (  0%)
 TOTAL                              :   0.12          0.00          0.13         2384k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)  2157k ( 70%)
 phase opt and generate             :   0.01 (100%)   0.02 (100%)   0.03 ( 75%)   850k ( 28%)
 callgraph functions expansion      :   0.01 (100%)   0.02 (100%)   0.03 ( 75%)   680k ( 22%)
 tree reassociation                 :   0.00 (  0%)   0.01 ( 50%)   0.00 (  0%)    48  (  0%)
 tree SSA uncprop                   :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)     0  (  0%)
 combiner                           :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)    10k (  0%)
 rest of compilation                :   0.01 (100%)   0.01 ( 50%)   0.01 ( 25%)    32k (  1%)
 TOTAL                              :   0.01          0.02          0.04         3073k
/usr/bin/ld: /tmp/cc6wzMwL.ltrans0.ltrans.o: in function `svr4_read_so_list':
<artificial>:(.text+0x1e7): undefined reference to `target_gdbarch'
/usr/bin/ld: <artificial>:(.text+0x1f6): undefined reference to `paddress'
/usr/bin/ld: <artificial>:(.text+0x202): undefined reference to `target_gdbarch'
/usr/bin/ld: <artificial>:(.text+0x211): undefined reference to `paddress'
/usr/bin/ld: <artificial>:(.text+0x222): undefined reference to `_'
/usr/bin/ld: <artificial>:(.text+0x232): undefined reference to `warning'
/usr/bin/ld: <artificial>:(.text+0x248): undefined reference to `get_svr4_info'
/usr/bin/ld: <artificial>:(.text+0x26c): undefined reference to `safe_strerror'
/usr/bin/ld: <artificial>:(.text+0x27d): undefined reference to `_'
/usr/bin/ld: <artificial>:(.text+0x28b): undefined reference to `warning'
/usr/bin/ld: <artificial>:(.text+0x2cf): undefined reference to `lm_info_read'
/usr/bin/ld: <artificial>:(.text+0x31b): undefined reference to `target_read_string'
/usr/bin/ld: <artificial>:(.text+0x392): undefined reference to `match_main'
collect2: error: ld returned 1 exit status
