In file included from ./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:9:
./benchmarks/openssh-portable/double_free_4/../openssh.h:675:60: warning: ‘struct ssh’ declared inside parameter list will not be visible outside of this definition or declaration
  675 |         int     (*verify_host_key)(struct sshkey *, struct ssh *);
      |                                                            ^~~
./benchmarks/openssh-portable/double_free_4/../openssh.h:676:65: warning: ‘struct ssh’ declared inside parameter list will not be visible outside of this definition or declaration
  676 |         struct sshkey *(*load_host_public_key)(int, int, struct ssh *);
      |                                                                 ^~~
./benchmarks/openssh-portable/double_free_4/../openssh.h:677:66: warning: ‘struct ssh’ declared inside parameter list will not be visible outside of this definition or declaration
  677 |         struct sshkey *(*load_host_private_key)(int, int, struct ssh *);
      |                                                                  ^~~
./benchmarks/openssh-portable/double_free_4/../openssh.h:678:64: warning: ‘struct ssh’ declared inside parameter list will not be visible outside of this definition or declaration
  678 |         int     (*host_key_index)(struct sshkey *, int, struct ssh *);
      |                                                                ^~~
./benchmarks/openssh-portable/double_free_4/../openssh.h:681:40: warning: ‘struct ssh’ declared inside parameter list will not be visible outside of this definition or declaration
  681 |         int     (*kex[KEX_MAX])(struct ssh *);
      |                                        ^~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c: In function ‘percent_expand’:
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:49:29: warning: implicit declaration of function ‘strchr’ [-Wimplicit-function-declaration]
   49 |                         if (strchr(keys[j].key, *string) != NULL) {
      |                             ^~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:10:1: note: include ‘<string.h>’ or provide a declaration of ‘strchr’
    9 | #include "../openssh.h"
  +++ |+#include <string.h>
   10 | 
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:49:29: warning: incompatible implicit declaration of built-in function ‘strchr’ [-Wbuiltin-declaration-mismatch]
   49 |                         if (strchr(keys[j].key, *string) != NULL) {
      |                             ^~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:49:29: note: include ‘<string.h>’ or provide a declaration of ‘strchr’
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:50:37: warning: implicit declaration of function ‘strlcat’ [-Wimplicit-function-declaration]
   50 |                                 i = strlcat(buf, keys[j].repl, sizeof(buf));
      |                                     ^~~~~~~
In file included from ./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:8:
./benchmarks/openssh-portable/double_free_4/../stdio.h:266:20: warning: implicit declaration of function ‘strdup’ [-Wimplicit-function-declaration]
  266 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:59:17: note: in expansion of macro ‘xstrdup’
   59 |         return (xstrdup(buf));
      |                 ^~~~~~~
./benchmarks/openssh-portable/double_free_4/../stdio.h:266:20: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
  266 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:59:17: note: in expansion of macro ‘xstrdup’
   59 |         return (xstrdup(buf));
      |                 ^~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c: In function ‘expand_authorized_keys’:
./benchmarks/openssh-portable/double_free_4/../stdio.h:266:20: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
  266 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:91:17: note: in expansion of macro ‘xstrdup’
   91 |         return (xstrdup(ret));
      |                 ^~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c: In function ‘read_keyfile_line’:
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:106:25: warning: implicit declaration of function ‘strlen’ [-Wimplicit-function-declaration]
  106 |                 if (buf[strlen(buf) - 1] == '\n' || feof(f)) {
      |                         ^~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:106:25: note: include ‘<string.h>’ or provide a declaration of ‘strlen’
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:106:25: warning: incompatible implicit declaration of built-in function ‘strlen’ [-Wbuiltin-declaration-mismatch]
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:106:25: note: include ‘<string.h>’ or provide a declaration of ‘strlen’
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:109:25: warning: implicit declaration of function ‘debug’ [-Wimplicit-function-declaration]
  109 |                         debug("%s: %s line %lu exceeds size limit", __func__,
      |                         ^~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c: In function ‘user_key_allowed2’:
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:139:9: warning: implicit declaration of function ‘temporarily_use_uid’ [-Wimplicit-function-declaration]
  139 |         temporarily_use_uid(pw);
      |         ^~~~~~~~~~~~~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:142:13: warning: implicit declaration of function ‘auth_openkeyfile’ [-Wimplicit-function-declaration]
  142 |         f = auth_openkeyfile(file, pw, 0);
      |             ^~~~~~~~~~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:142:11: warning: assignment to ‘FILE *’ from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
  142 |         f = auth_openkeyfile(file, pw, 0);
      |           ^
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:146:9: warning: implicit declaration of function ‘restore_uid’ [-Wimplicit-function-declaration]
  146 |         restore_uid();
      |         ^~~~~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:151:17: warning: implicit declaration of function ‘key_new’ [-Wimplicit-function-declaration]
  151 |         found = key_new(key->type);
      |                 ^~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:151:15: warning: assignment to ‘Key *’ from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
  151 |         found = key_new(key->type);
      |               ^
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:162:21: warning: implicit declaration of function ‘key_read’ [-Wimplicit-function-declaration]
  162 |                 if (key_read(found, &cp) != 1) {
      |                     ^~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:165:25: warning: implicit declaration of function ‘debug2’ [-Wimplicit-function-declaration]
  165 |                         debug2("user_key_allowed: check options: '%s'", cp);
      |                         ^~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:182:21: warning: implicit declaration of function ‘key_equal’ [-Wimplicit-function-declaration]
  182 |                 if (key_equal(found, key) &&
      |                     ^~~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:183:21: warning: implicit declaration of function ‘auth_parse_options’ [-Wimplicit-function-declaration]
  183 |                     auth_parse_options(pw, key_options, file, linenum) == 1) {
      |                     ^~~~~~~~~~~~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:187:30: warning: implicit declaration of function ‘key_fingerprint’ [-Wimplicit-function-declaration]
  187 |                         fp = key_fingerprint(found, SSH_FP_MD5, SSH_FP_HEX);
      |                              ^~~~~~~~~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:187:28: warning: assignment to ‘char *’ from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
  187 |                         fp = key_fingerprint(found, SSH_FP_MD5, SSH_FP_HEX);
      |                            ^
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:188:25: warning: implicit declaration of function ‘verbose’ [-Wimplicit-function-declaration]
  188 |                         verbose("Found matching %s key: %s",
      |                         ^~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:189:29: warning: implicit declaration of function ‘key_type’ [-Wimplicit-function-declaration]
  189 |                             key_type(found), fp);
      |                             ^~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:196:9: warning: implicit declaration of function ‘key_free’ [-Wimplicit-function-declaration]
  196 |         key_free(found);
      |         ^~~~~~~~
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c: In function ‘user_key_allowed’:
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:216:16: warning: implicit declaration of function ‘authorized_keys_file2’; did you mean ‘authorized_keys_file’? [-Wimplicit-function-declaration]
  216 |         file = authorized_keys_file2(pw);
      |                ^~~~~~~~~~~~~~~~~~~~~
      |                authorized_keys_file
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:216:14: warning: assignment to ‘char *’ from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
  216 |         file = authorized_keys_file2(pw);
      |              ^

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 ( 14%)  1298k ( 43%)
 phase parsing                      :   0.04 ( 80%)   0.01 (100%)   0.05 ( 71%)  1434k ( 48%)
 phase opt and generate             :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 14%)   263k (  9%)
 callgraph ipa passes               :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 14%)   135k (  5%)
 preprocessing                      :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 14%)   640k ( 21%)
 lexical analysis                   :   0.01 ( 20%)   0.00 (  0%)   0.01 ( 14%)     0  (  0%)
 parser (global)                    :   0.00 (  0%)   0.00 (  0%)   0.01 ( 14%)   565k ( 19%)
 parser struct body                 :   0.01 ( 20%)   0.01 (100%)   0.00 (  0%)   115k (  4%)
 parser function body               :   0.01 ( 20%)   0.00 (  0%)   0.02 ( 29%)    85k (  3%)
 tree CFG cleanup                   :   0.01 ( 20%)   0.00 (  0%)   0.00 (  0%)   560  (  0%)
 backwards jump threading           :   0.00 (  0%)   0.00 (  0%)   0.01 ( 14%)     0  (  0%)
 TOTAL                              :   0.05          0.01          0.07         3006k
In function ‘user_key_allowed’:
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:211:9: warning: double-‘free’ of ‘file_8’ [CWE-415] [-Wanalyzer-double-free]
  211 |         xfree(file); /* double-free */
      |         ^
  ‘main’: events 1-2
    |
    |  222 | int main()
    |      |     ^
    |      |     |
    |      |     (1) entry to ‘main’
    |......
    |  226 |     user_key_allowed(&pw, &key);
    |      |     ~
    |      |     |
    |      |     (2) calling ‘user_key_allowed’ from ‘main’
    |
    +--> ‘user_key_allowed’: events 3-4
           |
           |  204 | user_key_allowed(struct passwd *pw, Key *key)
           |      | ^
           |      | |
           |      | (3) entry to ‘user_key_allowed’
           |......
           |  209 |         file = authorized_keys_file(pw);
           |      |                ~
           |      |                |
           |      |                (4) calling ‘authorized_keys_file’ from ‘user_key_allowed’
           |
           +--> ‘authorized_keys_file’: events 5-6
                  |
                  |  121 | authorized_keys_file(struct passwd *pw)
                  |      | ^
                  |      | |
                  |      | (5) entry to ‘authorized_keys_file’
                  |  122 | {
                  |  123 |         return expand_authorized_keys("filename", pw);
                  |      |                ~
                  |      |                |
                  |      |                (6) calling ‘expand_authorized_keys’ from ‘authorized_keys_file’
                  |
                  +--> ‘expand_authorized_keys’: events 7-8
                         |
                         |   72 | expand_authorized_keys(const char *filename, struct passwd *pw)
                         |      | ^
                         |      | |
                         |      | (7) entry to ‘expand_authorized_keys’
                         |......
                         |   77 |         file = percent_expand(filename, "h", pw->pw_dir,
                         |      |                ~
                         |      |                |
                         |      |                (8) calling ‘percent_expand’ from ‘expand_authorized_keys’
                         |
                         +--> ‘percent_expand’: events 9-18
                                |
                                |   21 | percent_expand(const char *string, ...)
                                |      | ^
                                |      | |
                                |      | (9) entry to ‘percent_expand’
                                |......
                                |   31 |         if (num_keys >= EXPAND_MAX_KEYS)
                                |      |            ~
                                |      |            |
                                |      |            (10) following ‘false’ branch (when ‘num_keys_23(D) <= 15’)...
                                |......
                                |   35 |         *buf = '\0';
                                |      |              ~
                                |      |              |
                                |      |              (11) ...to here
                                |   36 |         for (i = 0; *string != '\0'; string++) {
                                |      |                             ~
                                |      |                             |
                                |      |                             (12) following ‘true’ branch...
                                |   37 |                 if (*string != '%') {
                                |      |                    ~~
                                |      |                    ||
                                |      |                    |(13) ...to here
                                |      |                    (14) following ‘true’ branch...
                                |   38 |  append:
                                |      |  ~
                                |      |  |
                                |      |  (15) ...to here
                                |   39 |                         buf[i++] = *string;
                                |   40 |                         if (i >= sizeof(buf))
                                |      |                            ~
                                |      |                            |
                                |      |                            (16) following ‘false’ branch (when ‘i_39 <= 4095’)...
                                |   41 |                                 fatal("percent_expand: string too long%s", "");
                                |   42 |                         buf[i] = '\0';
                                |      |                                ~
                                |      |                                |
                                |      |                                (17) ...to here
                                |......
                                |   59 |         return (xstrdup(buf));
                                |      |                 ~
                                |      |                 |
                                |      |                 (18) allocated here
                                |
                         <------+
                         |
                       ‘expand_authorized_keys’: events 19-21
                         |
                         |   77 |         file = percent_expand(filename, "h", pw->pw_dir,
                         |      |                ^
                         |      |                |
                         |      |                (19) returning to ‘expand_authorized_keys’ from ‘percent_expand’
                         |......
                         |   84 |         if (*file == '/')
                         |      |            ~~   
                         |      |            ||
                         |      |            |(20) assuming ‘file_12’ is non-NULL
                         |      |            (21) following ‘true’ branch...
                         |
                       ‘expand_authorized_keys’: event 22
                         |
                         |lto1:
                         | (22): ...to here
                         |
                  <------+
                  |
                ‘authorized_keys_file’: event 23
                  |
                  |  123 |         return expand_authorized_keys("filename", pw);
                  |      |                ^
                  |      |                |
                  |      |                (23) returning to ‘authorized_keys_file’ from ‘expand_authorized_keys’
                  |
           <------+
           |
         ‘user_key_allowed’: events 24-25
           |
           |  209 |         file = authorized_keys_file(pw);
           |      |                ^
           |      |                |
           |      |                (24) returning to ‘user_key_allowed’ from ‘authorized_keys_file’
           |  210 |         success = user_key_allowed2(pw, key, file);
           |      |                   ~
           |      |                   |
           |      |                   (25) calling ‘user_key_allowed2’ from ‘user_key_allowed’
           |
           +--> ‘user_key_allowed2’: events 26-29
                  |
                  |  129 | user_key_allowed2(struct passwd *pw, Key *key, char *file)
                  |      | ^
                  |      | |
                  |      | (26) entry to ‘user_key_allowed2’
                  |......
                  |  144 |         if (!f) {
                  |      |            ~
                  |      |            |
                  |      |            (27) following ‘true’ branch...
                  |  145 |         xfree(file); /* double free */
                  |      |         ~
                  |      |         |
                  |      |         (28) ...to here
                  |      |         (29) first ‘free’ here
                  |
           <------+
           |
         ‘user_key_allowed’: events 30-31
           |
           |  210 |         success = user_key_allowed2(pw, key, file);
           |      |                   ^
           |      |                   |
           |      |                   (30) returning to ‘user_key_allowed’ from ‘user_key_allowed2’
           |  211 |         xfree(file); /* double-free */
           |      |         ~          
           |      |         |
           |      |         (31) second ‘free’ here; first ‘free’ was at (29)
           |
In function ‘expand_authorized_keys’:
./benchmarks/openssh-portable/double_free_4/openssh_df_4.c:84:13: warning: dereference of possibly-NULL ‘file_12’ [CWE-690] [-Wanalyzer-possible-null-dereference]
   84 |         if (*file == '/')
      |             ^
  ‘main’: events 1-2
    |
    |  222 | int main()
    |      |     ^
    |      |     |
    |      |     (1) entry to ‘main’
    |......
    |  226 |     user_key_allowed(&pw, &key);
    |      |     ~
    |      |     |
    |      |     (2) calling ‘user_key_allowed’ from ‘main’
    |
    +--> ‘user_key_allowed’: events 3-4
           |
           |  204 | user_key_allowed(struct passwd *pw, Key *key)
           |      | ^
           |      | |
           |      | (3) entry to ‘user_key_allowed’
           |......
           |  209 |         file = authorized_keys_file(pw);
           |      |                ~
           |      |                |
           |      |                (4) calling ‘authorized_keys_file’ from ‘user_key_allowed’
           |
           +--> ‘authorized_keys_file’: events 5-6
                  |
                  |  121 | authorized_keys_file(struct passwd *pw)
                  |      | ^
                  |      | |
                  |      | (5) entry to ‘authorized_keys_file’
                  |  122 | {
                  |  123 |         return expand_authorized_keys("filename", pw);
                  |      |                ~
                  |      |                |
                  |      |                (6) calling ‘expand_authorized_keys’ from ‘authorized_keys_file’
                  |
                  +--> ‘expand_authorized_keys’: events 7-8
                         |
                         |   72 | expand_authorized_keys(const char *filename, struct passwd *pw)
                         |      | ^
                         |      | |
                         |      | (7) entry to ‘expand_authorized_keys’
                         |......
                         |   77 |         file = percent_expand(filename, "h", pw->pw_dir,
                         |      |                ~
                         |      |                |
                         |      |                (8) calling ‘percent_expand’ from ‘expand_authorized_keys’
                         |
                         +--> ‘percent_expand’: events 9-18
                                |
                                |   21 | percent_expand(const char *string, ...)
                                |      | ^
                                |      | |
                                |      | (9) entry to ‘percent_expand’
                                |......
                                |   31 |         if (num_keys >= EXPAND_MAX_KEYS)
                                |      |            ~
                                |      |            |
                                |      |            (10) following ‘false’ branch (when ‘num_keys_23(D) <= 15’)...
                                |......
                                |   35 |         *buf = '\0';
                                |      |              ~
                                |      |              |
                                |      |              (11) ...to here
                                |   36 |         for (i = 0; *string != '\0'; string++) {
                                |      |                             ~
                                |      |                             |
                                |      |                             (12) following ‘true’ branch...
                                |   37 |                 if (*string != '%') {
                                |      |                    ~~
                                |      |                    ||
                                |      |                    |(13) ...to here
                                |      |                    (14) following ‘true’ branch...
                                |   38 |  append:
                                |      |  ~
                                |      |  |
                                |      |  (15) ...to here
                                |   39 |                         buf[i++] = *string;
                                |   40 |                         if (i >= sizeof(buf))
                                |      |                            ~
                                |      |                            |
                                |      |                            (16) following ‘false’ branch (when ‘i_39 <= 4095’)...
                                |   41 |                                 fatal("percent_expand: string too long%s", "");
                                |   42 |                         buf[i] = '\0';
                                |      |                                ~
                                |      |                                |
                                |      |                                (17) ...to here
                                |......
                                |   59 |         return (xstrdup(buf));
                                |      |                 ~
                                |      |                 |
                                |      |                 (18) this call could return NULL
                                |
                         <------+
                         |
                       ‘expand_authorized_keys’: events 19-20
                         |
                         |   77 |         file = percent_expand(filename, "h", pw->pw_dir,
                         |      |                ^
                         |      |                |
                         |      |                (19) possible return of NULL to ‘expand_authorized_keys’ from ‘percent_expand’
                         |......
                         |   84 |         if (*file == '/')
                         |      |             ~   
                         |      |             |
                         |      |             (20) ‘file_12’ could be NULL: unchecked value from (18)
                         |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 90%)
 phase opt and generate             :   0.25 (100%)   0.00 (  0%)   0.25 (100%)   161k (  7%)
 analyzer                           :   0.01 (  4%)   0.00 (  0%)   0.01 (  4%)     0  (  0%)
 analyzer: processing worklist      :   0.23 ( 92%)   0.00 (  0%)   0.23 ( 92%)   288  (  0%)
 analyzer: emitting diagnostics     :   0.01 (  4%)   0.00 (  0%)   0.01 (  4%)   728  (  0%)
 TOTAL                              :   0.25          0.00          0.25         2408k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 70%)
 phase opt and generate             :   0.04 (100%)   0.00 (  0%)   0.04 (100%)   860k ( 28%)
 callgraph functions expansion      :   0.04 (100%)   0.00 (  0%)   0.04 (100%)   673k ( 22%)
 dominator optimization             :   0.01 ( 25%)   0.00 (  0%)   0.00 (  0%)    28k (  1%)
 tree conservative DCE              :   0.01 ( 25%)   0.00 (  0%)   0.00 (  0%)  1352  (  0%)
 dead store elim2                   :   0.01 ( 25%)   0.00 (  0%)   0.00 (  0%)  7792  (  0%)
 loop init                          :   0.00 (  0%)   0.00 (  0%)   0.02 ( 50%)    63k (  2%)
 hard reg cprop                     :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)    96  (  0%)
 initialize rtl                     :   0.01 ( 25%)   0.00 (  0%)   0.01 ( 25%)    12k (  0%)
 TOTAL                              :   0.04          0.00          0.04         3103k
/usr/bin/ld: /tmp/ccT5DMBT.ltrans0.ltrans.o: in function `read_keyfile_line':
<artificial>:(.text+0x1a6): undefined reference to `debug'
/usr/bin/ld: /tmp/ccT5DMBT.ltrans0.ltrans.o: in function `user_key_allowed2':
<artificial>:(.text+0x20f): undefined reference to `temporarily_use_uid'
/usr/bin/ld: <artificial>:(.text+0x221): undefined reference to `debug'
/usr/bin/ld: <artificial>:(.text+0x236): undefined reference to `auth_openkeyfile'
/usr/bin/ld: <artificial>:(.text+0x251): undefined reference to `key_new'
/usr/bin/ld: <artificial>:(.text+0x2ce): undefined reference to `key_read'
/usr/bin/ld: <artificial>:(.text+0x2ed): undefined reference to `key_equal'
/usr/bin/ld: <artificial>:(.text+0x312): undefined reference to `auth_parse_options'
/usr/bin/ld: <artificial>:(.text+0x333): undefined reference to `debug'
/usr/bin/ld: <artificial>:(.text+0x34a): undefined reference to `key_fingerprint'
/usr/bin/ld: <artificial>:(.text+0x35a): undefined reference to `key_type'
/usr/bin/ld: <artificial>:(.text+0x36e): undefined reference to `verbose'
/usr/bin/ld: <artificial>:(.text+0x380): undefined reference to `restore_uid'
/usr/bin/ld: <artificial>:(.text+0x395): undefined reference to `key_free'
/usr/bin/ld: <artificial>:(.text+0x3ac): undefined reference to `restore_uid'
/usr/bin/ld: <artificial>:(.text+0x3c5): undefined reference to `debug2'
/usr/bin/ld: <artificial>:(.text+0x454): undefined reference to `key_read'
/usr/bin/ld: <artificial>:(.text+0x471): undefined reference to `debug2'
/usr/bin/ld: <artificial>:(.text+0x498): undefined reference to `restore_uid'
/usr/bin/ld: <artificial>:(.text+0x4ad): undefined reference to `key_free'
/usr/bin/ld: <artificial>:(.text+0x4bc): undefined reference to `debug2'
/usr/bin/ld: /tmp/ccT5DMBT.ltrans0.ltrans.o: in function `user_key_allowed':
<artificial>:(.text+0x525): undefined reference to `authorized_keys_file2'
collect2: error: ld returned 1 exit status
