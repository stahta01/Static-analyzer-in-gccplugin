./benchmarks/tmux/leak_4/tmux_leak_4.c:15: warning: "S_IRWXU" redefined
   15 | #define S_IRWXU 0
      | 
In file included from ./benchmarks/tmux/leak_4/tmux_leak_4.c:9:
/usr/include/x86_64-linux-gnu/sys/stat.h:172: note: this is the location of the previous definition
  172 | #define S_IRWXU (__S_IREAD|__S_IWRITE|__S_IEXEC)
      | 
./benchmarks/tmux/leak_4/tmux_leak_4.c:16: warning: "S_IRWXO" redefined
   16 | #define S_IRWXO 0
      | 
In file included from ./benchmarks/tmux/leak_4/tmux_leak_4.c:9:
/usr/include/x86_64-linux-gnu/sys/stat.h:190: note: this is the location of the previous definition
  190 | #define S_IRWXO (S_IRWXG >> 3)
      | 
./benchmarks/tmux/leak_4/tmux_leak_4.c: In function ‘vasprintf’:
./benchmarks/tmux/leak_4/tmux_leak_4.c:46:23: warning: implicit declaration of function ‘strlen’ [-Wimplicit-function-declaration]
   46 |         *ret = malloc(strlen(fmt) + strlen(ap));                /* allocation site */
      |                       ^~~~~~
./benchmarks/tmux/leak_4/tmux_leak_4.c:13:1: note: include ‘<string.h>’ or provide a declaration of ‘strlen’
   12 | #include "../tmux.h"
  +++ |+#include <string.h>
   13 | 
./benchmarks/tmux/leak_4/tmux_leak_4.c:46:23: warning: incompatible implicit declaration of built-in function ‘strlen’ [-Wbuiltin-declaration-mismatch]
   46 |         *ret = malloc(strlen(fmt) + strlen(ap));                /* allocation site */
      |                       ^~~~~~
./benchmarks/tmux/leak_4/tmux_leak_4.c:46:23: note: include ‘<string.h>’ or provide a declaration of ‘strlen’
./benchmarks/tmux/leak_4/tmux_leak_4.c: In function ‘xasprintf’:
./benchmarks/tmux/leak_4/tmux_leak_4.c:56:13: warning: implicit declaration of function ‘xvasprintf’; did you mean ‘xasprintf’? [-Wimplicit-function-declaration]
   56 |         i = xvasprintf(ret, fmt, ap);
      |             ^~~~~~~~~~
      |             xasprintf
In file included from ./benchmarks/tmux/leak_4/tmux_leak_4.c:11:
./benchmarks/tmux/leak_4/tmux_leak_4.c: In function ‘xvasprintf’:
./benchmarks/tmux/leak_4/tmux_leak_4.c:69:41: warning: implicit declaration of function ‘strerror’; did you mean ‘perror’? [-Wimplicit-function-declaration]
   69 |                 fatalx("xasprintf: %s", strerror(errno));
      |                                         ^~~~~~~~
./benchmarks/tmux/leak_4/../stdio.h:135:33: note: in definition of macro ‘fatal’
  135 | #define fatal(a, b) { printf(a, b); exit(1); }
      |                                 ^
./benchmarks/tmux/leak_4/tmux_leak_4.c:69:17: note: in expansion of macro ‘fatalx’
   69 |                 fatalx("xasprintf: %s", strerror(errno));
      |                 ^~~~~~
./benchmarks/tmux/leak_4/tmux_leak_4.c: In function ‘make_label’:
./benchmarks/tmux/leak_4/tmux_leak_4.c:84:15: warning: implicit declaration of function ‘getuid’ [-Wimplicit-function-declaration]
   84 |         uid = getuid();
      |               ^~~~~~

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  1298k ( 41%)
 phase parsing                      :   0.04 (100%)   0.01 (100%)   0.05 ( 83%)  1719k ( 54%)
 phase opt and generate             :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)   142k (  4%)
 callgraph ipa passes               :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)    73k (  2%)
 preprocessing                      :   0.02 ( 50%)   0.01 (100%)   0.01 ( 17%)   817k ( 26%)
 lexical analysis                   :   0.01 ( 25%)   0.00 (  0%)   0.02 ( 33%)     0  (  0%)
 parser (global)                    :   0.00 (  0%)   0.00 (  0%)   0.02 ( 33%)   609k ( 19%)
 parser function body               :   0.01 ( 25%)   0.00 (  0%)   0.00 (  0%)    39k (  1%)
 branch prediction                  :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)  2632  (  0%)
 TOTAL                              :   0.04          0.01          0.06         3170k
./benchmarks/tmux/leak_4/tmux_leak_4.c: In function ‘make_label’:
./benchmarks/tmux/leak_4/tmux_leak_4.c:116:1: warning: leak of ‘base’ [CWE-401] [-Wanalyzer-malloc-leak]
  116 | }
      | ^
  ‘make_label’: events 1-2
    |
    |   75 | make_label(const char *label)
    |      | ^
    |      | |
    |      | (1) entry to ‘make_label’
    |......
    |   89 |                 xasprintf(&base, "%s/tmux-", _PATH_TMP);
    |      |                 ~
    |      |                 |
    |      |                 (2) calling ‘xasprintf’ from ‘make_label’
    |
    +--> ‘xasprintf’: events 3-4
           |
           |   52 | xasprintf(char **ret, const char *fmt, char *ap)
           |      | ^
           |      | |
           |      | (3) entry to ‘xasprintf’
           |......
           |   56 |         i = xvasprintf(ret, fmt, ap);
           |      |             ~
           |      |             |
           |      |             (4) calling ‘xvasprintf’ from ‘xasprintf’
           |
           +--> ‘xvasprintf’: events 5-6
                  |
                  |   62 | xvasprintf(char **ret, const char *fmt, va_list ap)
                  |      | ^
                  |      | |
                  |      | (5) entry to ‘xvasprintf’
                  |......
                  |   66 |         i = vasprintf(ret, fmt, ap);
                  |      |             ~
                  |      |             |
                  |      |             (6) calling ‘vasprintf’ from ‘xvasprintf’
                  |
                  +--> ‘vasprintf’: events 7-10
                         |
                         |   44 | int vasprintf(char **ret, const char *fmt, char *ap)
                         |      |     ^
                         |      |     |
                         |      |     (7) entry to ‘vasprintf’
                         |   45 | {
                         |   46 |         *ret = malloc(strlen(fmt) + strlen(ap));                /* allocation site */
                         |      |                ~
                         |      |                |
                         |      |                (8) allocated here
                         |   47 |         if(*ret == NULL) return -1;
                         |      |           ~
                         |      |           |
                         |      |           (9) assuming ‘base’ is non-NULL
                         |      |           (10) following ‘false’ branch...
                         |
                       ‘vasprintf’: event 11
                         |
                         |lto1:
                         | (11): ...to here
                         |
                  <------+
                  |
                ‘xvasprintf’: events 12-14
                  |
                  |   66 |         i = vasprintf(ret, fmt, ap);
                  |      |             ^
                  |      |             |
                  |      |             (12) returning to ‘xvasprintf’ from ‘vasprintf’
                  |   67 | 
                  |   68 |         if (i < 0 || *ret == NULL)
                  |      |            ~ 
                  |      |            |
                  |      |            (13) following ‘false’ branch...
                  |......
                  |   71 |         return i;
                  |      |                ~
                  |      |                |
                  |      |                (14) ...to here
                  |
           <------+
           |
         ‘xasprintf’: event 15
           |
           |   56 |         i = xvasprintf(ret, fmt, ap);
           |      |             ^
           |      |             |
           |      |             (15) returning to ‘xasprintf’ from ‘xvasprintf’
           |
    <------+
    |
  ‘make_label’: events 16-23
    |
    |   89 |                 xasprintf(&base, "%s/tmux-", _PATH_TMP);
    |      |                 ^
    |      |                 |
    |      |                 (16) returning to ‘make_label’ from ‘xasprintf’
    |......
    |   94 |         if (lstat(base, &sb) != 0)
    |      |            ~     
    |      |            |
    |      |            (17) following ‘false’ branch...
    |   95 |                 goto fail;
    |   96 |         if (!S_ISDIR(sb.st_mode)) {
    |      |            ~ ~   
    |      |            | |
    |      |            | (18) ...to here
    |      |            (19) following ‘false’ branch...
    |......
    |  100 |         if (sb.st_uid != uid || (sb.st_mode & S_IRWXO) != 0) {
    |      |            ~  ~  
    |      |            |  |
    |      |            |  (20) ...to here
    |      |            (21) following ‘false’ branch...
    |......
    |  105 |         if (realpath(base, resolved) == NULL)
    |      |             ~    
    |      |             |
    |      |             (22) ...to here
    |......
    |  116 | }
    |      | ~                
    |      | |
    |      | (23) ‘base’ leaks here; was allocated at (8)
    |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 ( 20%)  2157k ( 94%)
 phase opt and generate             :   0.02 (100%)   0.02 (100%)   0.04 ( 80%)    89k (  4%)
 analyzer: processing worklist      :   0.02 (100%)   0.02 (100%)   0.03 ( 60%)   488  (  0%)
 analyzer: emitting diagnostics     :   0.00 (  0%)   0.00 (  0%)   0.01 ( 20%)   576  (  0%)
 TOTAL                              :   0.02          0.02          0.05         2301k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 80%)
 phase opt and generate             :   0.01 (100%)   0.01 (100%)   0.02 (100%)   491k ( 18%)
 callgraph functions expansion      :   0.01 (100%)   0.01 (100%)   0.02 (100%)   391k ( 15%)
 tree forward propagate             :   0.00 (  0%)   0.00 (  0%)   0.01 ( 50%)  3168  (  0%)
 PHI merge                          :   0.00 (  0%)   0.00 (  0%)   0.01 ( 50%)     0  (  0%)
 initialize rtl                     :   0.00 (  0%)   0.01 (100%)   0.00 (  0%)    12k (  0%)
 rest of compilation                :   0.01 (100%)   0.00 (  0%)   0.00 (  0%)    15k (  1%)
 TOTAL                              :   0.01          0.01          0.02         2700k
