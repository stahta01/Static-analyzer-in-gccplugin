./benchmarks/tmux/leak_7/tmux_leak_7.c: In function ‘format_cmp’:
./benchmarks/tmux/leak_7/tmux_leak_7.c:89:17: warning: implicit declaration of function ‘strcmp’ [-Wimplicit-function-declaration]
   89 |         return (strcmp(fe1->key, fe2->key));
      |                 ^~~~~~
./benchmarks/tmux/leak_7/tmux_leak_7.c:11:1: note: include ‘<string.h>’ or provide a declaration of ‘strcmp’
   10 | #include "../tmux.h"
  +++ |+#include <string.h>
   11 | 
./benchmarks/tmux/leak_7/tmux_leak_7.c: In function ‘cmd_find_window_match’:
./benchmarks/tmux/leak_7/tmux_leak_7.c:171:9: warning: implicit declaration of function ‘memset’ [-Wimplicit-function-declaration]
  171 |         memset(&find_data, 0, sizeof find_data);
      |         ^~~~~~
./benchmarks/tmux/leak_7/tmux_leak_7.c:171:9: note: include ‘<string.h>’ or provide a declaration of ‘memset’
./benchmarks/tmux/leak_7/tmux_leak_7.c:171:9: warning: incompatible implicit declaration of built-in function ‘memset’ [-Wbuiltin-declaration-mismatch]
./benchmarks/tmux/leak_7/tmux_leak_7.c:171:9: note: include ‘<string.h>’ or provide a declaration of ‘memset’
./benchmarks/tmux/leak_7/tmux_leak_7.c:178:21: warning: implicit declaration of function ‘fnmatch’; did you mean ‘rpmatch’? [-Wimplicit-function-declaration]
  178 |                     fnmatch(searchstr, wl->window->name, 0) == 0) {
      |                     ^~~~~~~
      |                     rpmatch
In file included from ./benchmarks/tmux/leak_7/tmux_leak_7.c:9:
./benchmarks/tmux/leak_7/../stdio.h:138:20: warning: implicit declaration of function ‘strdup’ [-Wimplicit-function-declaration]
  138 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/tmux/leak_7/tmux_leak_7.c:179:46: note: in expansion of macro ‘xstrdup’
  179 |                         find_data.list_ctx = xstrdup("");                               /* allocation site */
      |                                              ^~~~~~~
./benchmarks/tmux/leak_7/../stdio.h:138:20: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
  138 | #define xstrdup(a) strdup(a)
      |                    ^~~~~~
./benchmarks/tmux/leak_7/tmux_leak_7.c:179:46: note: in expansion of macro ‘xstrdup’
  179 |                         find_data.list_ctx = xstrdup("");                               /* allocation site */
      |                                              ^~~~~~~
./benchmarks/tmux/leak_7/tmux_leak_7.c:185:46: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
  185 |                         find_data.list_ctx = strdup(wp->base.title);    /* allocation site */
      |                                              ^~~~~~

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)  1298k ( 25%)
 phase parsing                      :   0.04 ( 50%)   0.03 (100%)   0.07 ( 58%)  2425k ( 47%)
 phase opt and generate             :   0.04 ( 50%)   0.00 (  0%)   0.04 ( 33%)  1412k ( 27%)
 callgraph construction             :   0.01 ( 13%)   0.00 (  0%)   0.01 (  8%)   285k (  6%)
 callgraph ipa passes               :   0.03 ( 38%)   0.00 (  0%)   0.03 ( 25%)   549k ( 11%)
 lto stream compression             :   0.01 ( 12%)   0.00 (  0%)   0.00 (  0%)     0  (  0%)
 ipa lto decl out                   :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)   264  (  0%)
 preprocessing                      :   0.02 ( 25%)   0.00 (  0%)   0.01 (  8%)   980k ( 19%)
 lexical analysis                   :   0.00 (  0%)   0.02 ( 67%)   0.05 ( 42%)     0  (  0%)
 parser (global)                    :   0.01 ( 12%)   0.00 (  0%)   0.01 (  8%)   599k ( 12%)
 parser struct body                 :   0.01 ( 12%)   0.00 (  0%)   0.00 (  0%)   162k (  3%)
 parser function body               :   0.00 (  0%)   0.01 ( 33%)   0.00 (  0%)   585k ( 11%)
 tree PTA                           :   0.01 ( 12%)   0.00 (  0%)   0.00 (  0%)    31k (  1%)
 tree CCP                           :   0.00 (  0%)   0.00 (  0%)   0.01 (  8%)  5272  (  0%)
 loop init                          :   0.01 ( 13%)   0.00 (  0%)   0.01 (  8%)    42k (  1%)
 TOTAL                              :   0.08          0.03          0.12         5147k
./benchmarks/tmux/leak_7/tmux_leak_7.c: In function ‘cmd_find_window_match’:
./benchmarks/tmux/leak_7/tmux_leak_7.c:189:22: warning: leak of ‘strdup ("")’ [CWE-401] [-Wanalyzer-malloc-leak]
  189 |         if (find_data.list_ctx != NULL) {
      |                      ^
  ‘cmd_find_window_exec’: events 1-2
    |
    |  196 | enum cmd_retval cmd_find_window_exec(struct cmd *self, struct cmd_q *cmdq)
    |      |                 ^
    |      |                 |
    |      |                 (1) entry to ‘cmd_find_window_exec’
    |......
    |  211 |         RB_FOREACH(wm, winlinks, &s->windows)
    |      |         ~        
    |      |         |
    |      |         (2) calling ‘winlinks_RB_MINMAX’ from ‘cmd_find_window_exec’
    |
    +--> ‘winlinks_RB_MINMAX’: events 3-5
           |
           |  101 | RB_GENERATE(winlinks, winlink, entry, winlink_cmp);
           |      | ^
           |      | |
           |      | (3) entry to ‘winlinks_RB_MINMAX’
           |      | (4) following ‘true’ branch...
           |      | (5) ...to here
           |
    <------+
    |
  ‘cmd_find_window_exec’: events 6-9
    |
    |  211 |         RB_FOREACH(wm, winlinks, &s->windows)
    |      |         ^
    |      |         |
    |      |         (6) returning to ‘cmd_find_window_exec’ from ‘winlinks_RB_MINMAX’
    |      |         (7) following ‘true’ branch (when ‘wm_29’ is non-NULL)...
    |  212 |             cmd_find_window_match (&find_list, match_flags, wm, str, searchstr);
    |      |             ~
    |      |             |
    |      |             (8) ...to here
    |      |             (9) calling ‘cmd_find_window_match’ from ‘cmd_find_window_exec’
    |
    +--> ‘cmd_find_window_match’: events 10-17
           |
           |  162 | cmd_find_window_match(struct cmd_find_window_data_list *find_list,
           |      | ^
           |      | |
           |      | (10) entry to ‘cmd_find_window_match’
           |......
           |  179 |                         find_data.list_ctx = xstrdup("");                               /* allocation site */
           |      |                                              ~
           |      |                                              |
           |      |                                              (11) allocated here
           |......
           |  189 |         if (find_data.list_ctx != NULL) {
           |      |            ~
           |      |            |
           |      |            (12) assuming ‘find_data.list_ctx’ is non-NULL
           |......
           |  192 |                 ARRAY_ADD(find_list, find_data);
           |      |                 ~
           |      |                 |
           |      |                 (13) following ‘false’ branch...
           |      |                 (14) ...to here
           |      |                 (15) following ‘true’ branch...
           |      |                 (16) ...to here
           |      |                 (17) calling ‘xrealloc’ from ‘cmd_find_window_match’
           |
           +--> ‘xrealloc’: events 18-24
                  |
                  |  104 | xrealloc(void *oldptr, size_t nmemb, size_t size)
                  |      | ^
                  |      | |
                  |      | (18) entry to ‘xrealloc’
                  |......
                  |  109 |         if (newsize == 0)
                  |      |            ~
                  |      |            |
                  |      |            (19) following ‘false’ branch (when ‘newsize_7 != 0’)...
                  |  110 |                 fatalx("zero size%s", "");
                  |  111 |         if (1 << 30 / nmemb < size)
                  |      |            ~        ~
                  |      |            |        |
                  |      |            |        (20) ...to here
                  |      |            (21) following ‘false’ branch...
                  |  112 |                 fatalx("nmemb * size > SIZE_MAX%s", "");
                  |  113 |         if ((newptr = realloc(oldptr, newsize)) == NULL)
                  |      |            ~          ~
                  |      |            |          |
                  |      |            |          (22) ...to here
                  |      |            (23) following ‘false’ branch (when ‘newptr_11’ is non-NULL)...
                  |......
                  |  116 |         return (newptr);
                  |      |                ~
                  |      |                |
                  |      |                (24) ...to here
                  |
           <------+
           |
         ‘cmd_find_window_match’: events 25-28
           |
           |  189 |         if (find_data.list_ctx != NULL) {
           |      |                      ~
           |      |                      |
           |      |                      (28) ‘strdup ("")’ leaks here; was allocated at (11)
           |......
           |  192 |                 ARRAY_ADD(find_list, find_data);
           |      |                 ^
           |      |                 |
           |      |                 (25) returning to ‘cmd_find_window_match’ from ‘xrealloc’
           |      |                 (26) following ‘false’ branch...
           |      |                 (27) ...to here
           |
./benchmarks/tmux/leak_7/tmux_leak_7.c:189:22: warning: leak of ‘strdup (wp_39->base.title)’ [CWE-401] [-Wanalyzer-malloc-leak]
  189 |         if (find_data.list_ctx != NULL) {
      |                      ^
  ‘cmd_find_window_exec’: events 1-2
    |
    |  196 | enum cmd_retval cmd_find_window_exec(struct cmd *self, struct cmd_q *cmdq)
    |      |                 ^
    |      |                 |
    |      |                 (1) entry to ‘cmd_find_window_exec’
    |......
    |  211 |         RB_FOREACH(wm, winlinks, &s->windows)
    |      |         ~        
    |      |         |
    |      |         (2) calling ‘winlinks_RB_MINMAX’ from ‘cmd_find_window_exec’
    |
    +--> ‘winlinks_RB_MINMAX’: events 3-5
           |
           |  101 | RB_GENERATE(winlinks, winlink, entry, winlink_cmp);
           |      | ^
           |      | |
           |      | (3) entry to ‘winlinks_RB_MINMAX’
           |      | (4) following ‘true’ branch...
           |      | (5) ...to here
           |
    <------+
    |
  ‘cmd_find_window_exec’: events 6-9
    |
    |  211 |         RB_FOREACH(wm, winlinks, &s->windows)
    |      |         ^
    |      |         |
    |      |         (6) returning to ‘cmd_find_window_exec’ from ‘winlinks_RB_MINMAX’
    |      |         (7) following ‘true’ branch (when ‘wm_29’ is non-NULL)...
    |  212 |             cmd_find_window_match (&find_list, match_flags, wm, str, searchstr);
    |      |             ~
    |      |             |
    |      |             (8) ...to here
    |      |             (9) calling ‘cmd_find_window_match’ from ‘cmd_find_window_exec’
    |
    +--> ‘cmd_find_window_match’: events 10-17
           |
           |  162 | cmd_find_window_match(struct cmd_find_window_data_list *find_list,
           |      | ^
           |      | |
           |      | (10) entry to ‘cmd_find_window_match’
           |......
           |  185 |                         find_data.list_ctx = strdup(wp->base.title);    /* allocation site */
           |      |                                              ~
           |      |                                              |
           |      |                                              (11) allocated here
           |......
           |  189 |         if (find_data.list_ctx != NULL) {
           |      |            ~
           |      |            |
           |      |            (12) assuming ‘find_data.list_ctx’ is non-NULL
           |......
           |  192 |                 ARRAY_ADD(find_list, find_data);
           |      |                 ~
           |      |                 |
           |      |                 (13) following ‘false’ branch...
           |      |                 (14) ...to here
           |      |                 (15) following ‘true’ branch...
           |      |                 (16) ...to here
           |      |                 (17) calling ‘xrealloc’ from ‘cmd_find_window_match’
           |
           +--> ‘xrealloc’: events 18-24
                  |
                  |  104 | xrealloc(void *oldptr, size_t nmemb, size_t size)
                  |      | ^
                  |      | |
                  |      | (18) entry to ‘xrealloc’
                  |......
                  |  109 |         if (newsize == 0)
                  |      |            ~
                  |      |            |
                  |      |            (19) following ‘false’ branch (when ‘newsize_7 != 0’)...
                  |  110 |                 fatalx("zero size%s", "");
                  |  111 |         if (1 << 30 / nmemb < size)
                  |      |            ~        ~
                  |      |            |        |
                  |      |            |        (20) ...to here
                  |      |            (21) following ‘false’ branch...
                  |  112 |                 fatalx("nmemb * size > SIZE_MAX%s", "");
                  |  113 |         if ((newptr = realloc(oldptr, newsize)) == NULL)
                  |      |            ~          ~
                  |      |            |          |
                  |      |            |          (22) ...to here
                  |      |            (23) following ‘false’ branch (when ‘newptr_11’ is non-NULL)...
                  |......
                  |  116 |         return (newptr);
                  |      |                ~
                  |      |                |
                  |      |                (24) ...to here
                  |
           <------+
           |
         ‘cmd_find_window_match’: events 25-28
           |
           |  189 |         if (find_data.list_ctx != NULL) {
           |      |                      ~
           |      |                      |
           |      |                      (28) ‘strdup (wp_39->base.title)’ leaks here; was allocated at (11)
           |......
           |  192 |                 ARRAY_ADD(find_list, find_data);
           |      |                 ^
           |      |                 |
           |      |                 (25) returning to ‘cmd_find_window_match’ from ‘xrealloc’
           |      |                 (26) following ‘false’ branch...
           |      |                 (27) ...to here
           |
./benchmarks/tmux/leak_7/tmux_leak_7.c: In function ‘window_choose_data_create’:
./benchmarks/tmux/leak_7/tmux_leak_7.c:140:19: warning: dereference of possibly-NULL ‘wcd_10’ [CWE-690] [-Wanalyzer-possible-null-dereference]
  140 |         wcd->type = type;
      |                   ^
  ‘window_choose_data_create’: events 1-2
    |
    |  139 |         wcd = xmalloc(sizeof *wcd);
    |      |               ^
    |      |               |
    |      |               (1) this call could return NULL
    |  140 |         wcd->type = type;
    |      |                   ~
    |      |                   |
    |      |                   (2) ‘wcd_10’ could be NULL: unchecked value from (1)
    |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 71%)
 phase opt and generate             :   0.31 (100%)   0.01 (100%)   0.32 (100%)   704k ( 23%)
 ipa lto gimple in                  :   0.01 (  3%)   0.00 (  0%)   0.01 (  3%)   547k ( 18%)
 analyzer                           :   0.03 ( 10%)   0.00 (  0%)   0.03 (  9%)     0  (  0%)
 analyzer: processing worklist      :   0.25 ( 81%)   0.01 (100%)   0.26 ( 81%)  2192  (  0%)
 analyzer: emitting diagnostics     :   0.01 (  3%)   0.00 (  0%)   0.01 (  3%)   944  (  0%)
 analyzer: shortest paths           :   0.01 (  3%)   0.00 (  0%)   0.01 (  3%)     0  (  0%)
 TOTAL                              :   0.31          0.01          0.32         3030k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 67%)
 phase opt and generate             :   0.05 (100%)   0.00 (  0%)   0.06 (100%)   929k ( 29%)
 dump files                         :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)     0  (  0%)
 callgraph functions expansion      :   0.04 ( 80%)   0.00 (  0%)   0.05 ( 83%)   756k ( 23%)
 ipa points-to                      :   0.01 ( 20%)   0.00 (  0%)   0.00 (  0%)  9752  (  0%)
 tree operand scan                  :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)    28k (  1%)
 dominator optimization             :   0.00 (  0%)   0.00 (  0%)   0.02 ( 33%)    36k (  1%)
 tree loop invariant motion         :   0.02 ( 40%)   0.00 (  0%)   0.00 (  0%)  1040  (  0%)
 expand                             :   0.01 ( 20%)   0.00 (  0%)   0.00 (  0%)   110k (  3%)
 combiner                           :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)    35k (  1%)
 LRA non-specific                   :   0.01 ( 20%)   0.00 (  0%)   0.00 (  0%)  4704  (  0%)
 reload CSE regs                    :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)  7368  (  0%)
 TOTAL                              :   0.05          0.00          0.06         3223k
