./benchmarks/openssl/leak_8/openssl_leak_8.c: In function ‘psk_use_session_cb’:
./benchmarks/openssl/leak_8/openssl_leak_8.c:41:9: warning: implicit declaration of function ‘SSL_SESSION_up_ref’; did you mean ‘SSL_SESSION_free’? [-Wimplicit-function-declaration]
   41 |         SSL_SESSION_up_ref(psksess);
      |         ^~~~~~~~~~~~~~~~~~
      |         SSL_SESSION_free
In file included from ./benchmarks/openssl/leak_8/openssl_leak_8.c:9:
./benchmarks/openssl/leak_8/../openssl.h:10:34: warning: implicit declaration of function ‘strdup’ [-Wimplicit-function-declaration]
   10 | #define OPENSSL_hexstr2buf(a, b) strdup(a)
      |                                  ^~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:45:30: note: in expansion of macro ‘OPENSSL_hexstr2buf’
   45 |         unsigned char *key = OPENSSL_hexstr2buf(psk_key, &key_len);
      |                              ^~~~~~~~~~~~~~~~~~
./benchmarks/openssl/leak_8/../openssl.h:10:34: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
   10 | #define OPENSSL_hexstr2buf(a, b) strdup(a)
      |                                  ^~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:45:30: note: in expansion of macro ‘OPENSSL_hexstr2buf’
   45 |         unsigned char *key = OPENSSL_hexstr2buf(psk_key, &key_len);
      |                              ^~~~~~~~~~~~~~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:45:49: warning: passing argument 1 of ‘strdup’ makes pointer from integer without a cast [-Wint-conversion]
   45 |         unsigned char *key = OPENSSL_hexstr2buf(psk_key, &key_len);
      |                                                 ^~~~~~~
      |                                                 |
      |                                                 int
./benchmarks/openssl/leak_8/../openssl.h:10:41: note: in definition of macro ‘OPENSSL_hexstr2buf’
   10 | #define OPENSSL_hexstr2buf(a, b) strdup(a)
      |                                         ^
./benchmarks/openssl/leak_8/openssl_leak_8.c:45:49: note: expected ‘const char *’ but argument is of type ‘int’
   45 |         unsigned char *key = OPENSSL_hexstr2buf(psk_key, &key_len);
      |                                                 ^~~~~~~
./benchmarks/openssl/leak_8/../openssl.h:10:41: note: in definition of macro ‘OPENSSL_hexstr2buf’
   10 | #define OPENSSL_hexstr2buf(a, b) strdup(a)
      |                                         ^
./benchmarks/openssl/leak_8/openssl_leak_8.c:51:24: warning: implicit declaration of function ‘EVP_MD_size’ [-Wimplicit-function-declaration]
   51 |         if (key_len == EVP_MD_size(EVP_sha256()))
      |                        ^~~~~~~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:51:36: warning: implicit declaration of function ‘EVP_sha256’; did you mean ‘LN_sha256’? [-Wimplicit-function-declaration]
   51 |         if (key_len == EVP_MD_size(EVP_sha256()))
      |                                    ^~~~~~~~~~
      |                                    LN_sha256
./benchmarks/openssl/leak_8/openssl_leak_8.c:52:22: warning: implicit declaration of function ‘SSL_CIPHER_find’ [-Wimplicit-function-declaration]
   52 |             cipher = SSL_CIPHER_find(s, tls13_aes128gcmsha256_id);
      |                      ^~~~~~~~~~~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:52:20: warning: assignment to ‘const SSL_CIPHER *’ {aka ‘const struct ssl_cipher_st *’} from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
   52 |             cipher = SSL_CIPHER_find(s, tls13_aes128gcmsha256_id);
      |                    ^
./benchmarks/openssl/leak_8/openssl_leak_8.c:53:40: warning: implicit declaration of function ‘EVP_sha384’; did you mean ‘SN_sha384’? [-Wimplicit-function-declaration]
   53 |         else if(key_len == EVP_MD_size(EVP_sha384()))
      |                                        ^~~~~~~~~~
      |                                        SN_sha384
./benchmarks/openssl/leak_8/openssl_leak_8.c:54:20: warning: assignment to ‘const SSL_CIPHER *’ {aka ‘const struct ssl_cipher_st *’} from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
   54 |             cipher = SSL_CIPHER_find(s, tls13_aes256gcmsha384_id);
      |                    ^
./benchmarks/openssl/leak_8/openssl_leak_8.c:66:21: warning: implicit declaration of function ‘SSL_SESSION_set1_master_key’ [-Wimplicit-function-declaration]
   66 |                 || !SSL_SESSION_set1_master_key(usesess, key, key_len)
      |                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:67:21: warning: implicit declaration of function ‘SSL_SESSION_set_cipher’ [-Wimplicit-function-declaration]
   67 |                 || !SSL_SESSION_set_cipher(usesess, cipher))
      |                     ^~~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:71:14: warning: implicit declaration of function ‘SSL_SESSION_get0_cipher’ [-Wimplicit-function-declaration]
   71 |     cipher = SSL_SESSION_get0_cipher(usesess);
      |              ^~~~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:71:12: warning: assignment to ‘const SSL_CIPHER *’ {aka ‘const struct ssl_cipher_st *’} from ‘int’ makes pointer from integer without a cast [-Wint-conversion]
   71 |     cipher = SSL_SESSION_get0_cipher(usesess);
      |            ^
./benchmarks/openssl/leak_8/openssl_leak_8.c:75:23: warning: implicit declaration of function ‘SSL_CIPHER_get_handshake_digest’ [-Wimplicit-function-declaration]
   75 |     if (md != NULL && SSL_CIPHER_get_handshake_digest(cipher) != md) {
      |                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:75:63: warning: comparison between pointer and integer
   75 |     if (md != NULL && SSL_CIPHER_get_handshake_digest(cipher) != md) {
      |                                                               ^~
./benchmarks/openssl/leak_8/openssl_leak_8.c:84:18: warning: implicit declaration of function ‘strlen’ [-Wimplicit-function-declaration]
   84 |         *idlen = strlen(psk_identity);
      |                  ^~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:10:1: note: include ‘<string.h>’ or provide a declaration of ‘strlen’
    9 | #include "../openssl.h"
  +++ |+#include <string.h>
   10 | 
./benchmarks/openssl/leak_8/openssl_leak_8.c:84:18: warning: incompatible implicit declaration of built-in function ‘strlen’ [-Wbuiltin-declaration-mismatch]
   84 |         *idlen = strlen(psk_identity);
      |                  ^~~~~~
./benchmarks/openssl/leak_8/openssl_leak_8.c:84:18: note: include ‘<string.h>’ or provide a declaration of ‘strlen’

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 (  7%)  1298k ( 38%)
 phase parsing                      :   0.11 ( 92%)   0.02 (100%)   0.13 ( 87%)  1903k ( 56%)
 phase opt and generate             :   0.01 (  8%)   0.00 (  0%)   0.01 (  7%)   170k (  5%)
 callgraph ipa passes               :   0.01 (  8%)   0.00 (  0%)   0.01 (  7%)    51k (  2%)
 lto stream compression             :   0.00 (  0%)   0.00 (  0%)   0.01 (  7%)     0  (  0%)
 preprocessing                      :   0.01 (  8%)   0.00 (  0%)   0.02 ( 13%)  1081k ( 32%)
 lexical analysis                   :   0.02 ( 17%)   0.01 ( 50%)   0.01 (  7%)     0  (  0%)
 parser (global)                    :   0.00 (  0%)   0.01 ( 50%)   0.02 ( 13%)   682k ( 20%)
 parser function body               :   0.08 ( 67%)   0.00 (  0%)   0.08 ( 53%)    27k (  1%)
 branch prediction                  :   0.01 (  8%)   0.00 (  0%)   0.00 (  0%)   416  (  0%)
 TOTAL                              :   0.12          0.02          0.15         3381k
In function ‘psk_use_session_cb’:
./benchmarks/openssl/leak_8/openssl_leak_8.c:14:1: warning: leak of ‘key_38’ [CWE-401] [-Wanalyzer-malloc-leak]
   14 | }
      | ^
  ‘psk_use_session_cb’: events 1-11
    |
    |   14 | }
    |      | ~       
    |      | |
    |      | (11) ‘key_38’ leaks here; was allocated at (3)
    |......
    |   40 |     if (psksess != NULL) {
    |      |        ^
    |      |        |
    |      |        (1) following ‘false’ branch...
    |......
    |   45 |         unsigned char *key = OPENSSL_hexstr2buf(psk_key, &key_len);
    |      |                              ~
    |      |                              |
    |      |                              (2) ...to here
    |      |                              (3) allocated here
    |   46 | 
    |   47 |         if (key == NULL) {
    |      |            ~
    |      |            |
    |      |            (4) assuming ‘key_38’ is non-NULL
    |      |            (5) following ‘false’ branch (when ‘key_38’ is non-NULL)...
    |......
    |   51 |         if (key_len == EVP_MD_size(EVP_sha256()))
    |      |                        ~
    |      |                        |
    |      |                        (6) ...to here
    |......
    |   56 |         if (cipher == NULL) {
    |      |            ~
    |      |            |
    |      |            (7) following ‘false’ branch (when ‘cipher_28’ is non-NULL)...
    |......
    |   64 |         usesess = OPENSSL_malloc(sizeof(*usesess));
    |      |                   ~
    |      |                   |
    |      |                   (8) ...to here
    |   65 |         if (usesess == NULL
    |      |            ~
    |      |            |
    |      |            (9) following ‘true’ branch (when ‘usesess_50’ is NULL)...
    |......
    |   68 |             goto err;
    |      |             ~
    |      |             |
    |      |             (10) ...to here
    |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 95%)
 phase opt and generate             :   0.01 (100%)   0.00 (  0%)   0.01 (100%)    65k (  3%)
 lto stream decompression           :   0.00 (  0%)   0.00 (  0%)   0.01 (100%)     0  (  0%)
 analyzer: processing worklist      :   0.01 (100%)   0.00 (  0%)   0.00 (  0%)     0  (  0%)
 TOTAL                              :   0.01          0.00          0.01         2272k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 85%)
 phase opt and generate             :   0.02 (100%)   0.00 (  0%)   0.02 (100%)   328k ( 13%)
 callgraph functions expansion      :   0.02 (100%)   0.00 (  0%)   0.02 (100%)   252k ( 10%)
 LRA reload inheritance             :   0.00 (  0%)   0.00 (  0%)   0.01 ( 50%)     0  (  0%)
 final                              :   0.01 ( 50%)   0.00 (  0%)   0.00 (  0%)    13k (  1%)
 initialize rtl                     :   0.01 ( 50%)   0.00 (  0%)   0.01 ( 50%)    12k (  0%)
 TOTAL                              :   0.02          0.00          0.02         2533k
/usr/bin/ld: /tmp/ccTIUdO4.ltrans0.ltrans.o: in function `psk_use_session_cb':
<artificial>:(.text+0x43): undefined reference to `SSL_SESSION_up_ref'
/usr/bin/ld: <artificial>:(.text+0x57): undefined reference to `SSL_SESSION_get0_cipher'
/usr/bin/ld: <artificial>:(.text+0x75): undefined reference to `SSL_CIPHER_get_handshake_digest'
/usr/bin/ld: <artificial>:(.text+0xce): undefined reference to `EVP_sha256'
/usr/bin/ld: <artificial>:(.text+0xda): undefined reference to `EVP_MD_size'
/usr/bin/ld: <artificial>:(.text+0xe8): undefined reference to `EVP_sha384'
/usr/bin/ld: <artificial>:(.text+0xf4): undefined reference to `EVP_MD_size'
/usr/bin/ld: <artificial>:(.text+0x11f): undefined reference to `SSL_CIPHER_find'
/usr/bin/ld: <artificial>:(.text+0x14e): undefined reference to `SSL_SESSION_set1_master_key'
/usr/bin/ld: <artificial>:(.text+0x16e): undefined reference to `SSL_CIPHER_find'
/usr/bin/ld: <artificial>:(.text+0x183): undefined reference to `SSL_SESSION_set_cipher'
collect2: error: ld returned 1 exit status
