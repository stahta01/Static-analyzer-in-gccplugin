./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘getrn’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:87:23: warning: passing argument 1 of ‘CRYPTO_atomic_add’ from incompatible pointer type [-Wincompatible-pointer-types]
   87 |     CRYPTO_atomic_add(&lh->num_hash_calls, 1, &scratch);
      |                       ^~~~~~~~~~~~~~~~~~~
      |                       |
      |                       long unsigned int *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:70:28: note: expected ‘int *’ but argument is of type ‘long unsigned int *’
   70 | int CRYPTO_atomic_add(int *val, int amount, int *ret)
      |                       ~~~~~^~~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:97:27: warning: passing argument 1 of ‘CRYPTO_atomic_add’ from incompatible pointer type [-Wincompatible-pointer-types]
   97 |         CRYPTO_atomic_add(&lh->num_hash_comps, 1, &scratch);
      |                           ^~~~~~~~~~~~~~~~~~~
      |                           |
      |                           long unsigned int *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:70:28: note: expected ‘int *’ but argument is of type ‘long unsigned int *’
   70 | int CRYPTO_atomic_add(int *val, int amount, int *ret)
      |                       ~~~~~^~~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:102:27: warning: passing argument 1 of ‘CRYPTO_atomic_add’ from incompatible pointer type [-Wincompatible-pointer-types]
  102 |         CRYPTO_atomic_add(&lh->num_comp_calls, 1, &scratch);
      |                           ^~~~~~~~~~~~~~~~~~~
      |                           |
      |                           long unsigned int *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:70:28: note: expected ‘int *’ but argument is of type ‘long unsigned int *’
   70 | int CRYPTO_atomic_add(int *val, int amount, int *ret)
      |                       ~~~~~^~~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘lh_CONF_VALUE_new’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:139:12: warning: returning ‘OPENSSL_LHASH *’ {aka ‘struct lhash_st *’} from a function with incompatible return type ‘CONF_VALUE *’ [-Wincompatible-pointer-types]
  139 |     return (ret);
      |            ^
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘lh_CONF_VALUE_retrieve’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:158:27: warning: passing argument 1 of ‘CRYPTO_atomic_add’ from incompatible pointer type [-Wincompatible-pointer-types]
  158 |         CRYPTO_atomic_add(&lh->num_retrieve_miss, 1, &scratch);
      |                           ^~~~~~~~~~~~~~~~~~~~~~
      |                           |
      |                           long unsigned int *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:70:28: note: expected ‘int *’ but argument is of type ‘long unsigned int *’
   70 | int CRYPTO_atomic_add(int *val, int amount, int *ret)
      |                       ~~~~~^~~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:162:27: warning: passing argument 1 of ‘CRYPTO_atomic_add’ from incompatible pointer type [-Wincompatible-pointer-types]
  162 |         CRYPTO_atomic_add(&lh->num_retrieve, 1, &scratch);
      |                           ^~~~~~~~~~~~~~~~~
      |                           |
      |                           long unsigned int *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:70:28: note: expected ‘int *’ but argument is of type ‘long unsigned int *’
   70 | int CRYPTO_atomic_add(int *val, int amount, int *ret)
      |                       ~~~~~^~~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘_CONF_get_string’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:179:44: warning: passing argument 1 of ‘lh_CONF_VALUE_retrieve’ from incompatible pointer type [-Wincompatible-pointer-types]
  179 |             v = lh_CONF_VALUE_retrieve(conf->data, &vv);
      |                                        ~~~~^~~~~~
      |                                            |
      |                                            struct lhash_st_CONF_VALUE *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:147:45: note: expected ‘OPENSSL_LHASH *’ {aka ‘struct lhash_st *’} but argument is of type ‘struct lhash_st_CONF_VALUE *’
  147 | void *lh_CONF_VALUE_retrieve(OPENSSL_LHASH *lh, const void *data)
      |                              ~~~~~~~~~~~~~~~^~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:186:40: warning: passing argument 1 of ‘lh_CONF_VALUE_retrieve’ from incompatible pointer type [-Wincompatible-pointer-types]
  186 |         v = lh_CONF_VALUE_retrieve(conf->data, &vv);
      |                                    ~~~~^~~~~~
      |                                        |
      |                                        struct lhash_st_CONF_VALUE *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:147:45: note: expected ‘OPENSSL_LHASH *’ {aka ‘struct lhash_st *’} but argument is of type ‘struct lhash_st_CONF_VALUE *’
  147 | void *lh_CONF_VALUE_retrieve(OPENSSL_LHASH *lh, const void *data)
      |                              ~~~~~~~~~~~~~~~^~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘app_RAND_write’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:224:9: warning: implicit declaration of function ‘RAND_write_file’ [-Wimplicit-function-declaration]
  224 |     if (RAND_write_file(save_rand_file) == -1) {
      |         ^~~~~~~~~~~~~~~
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘_CONF_new_data’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:235:20: warning: assignment to ‘struct lhash_st_CONF_VALUE *’ from incompatible pointer type ‘CONF_VALUE *’ [-Wincompatible-pointer-types]
  235 |         conf->data = lh_CONF_VALUE_new();
      |                    ^
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘CONF_free’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:247:32: warning: passing argument 1 of ‘lh_CONF_VALUE_free’ from incompatible pointer type [-Wincompatible-pointer-types]
  247 |         lh_CONF_VALUE_free(conf->data);
      |                            ~~~~^~~~~~
      |                                |
      |                                struct lhash_st_CONF_VALUE *
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:111:40: note: expected ‘OPENSSL_LHASH *’ {aka ‘struct lhash_st *’} but argument is of type ‘struct lhash_st_CONF_VALUE *’
  111 | void lh_CONF_VALUE_free(OPENSSL_LHASH *lh)
      |                         ~~~~~~~~~~~~~~~^~

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  1298k ( 36%)
 phase parsing                      :   0.05 ( 83%)   0.00 (  0%)   0.05 ( 83%)  2011k ( 56%)
 phase opt and generate             :   0.01 ( 17%)   0.00 (  0%)   0.01 ( 17%)   251k (  7%)
 callgraph optimization             :   0.00 (  0%)   0.00 (  0%)   0.01 ( 17%)     0  (  0%)
 callgraph ipa passes               :   0.01 ( 17%)   0.00 (  0%)   0.01 ( 17%)   137k (  4%)
 preprocessing                      :   0.02 ( 33%)   0.00 (  0%)   0.02 ( 33%)  1087k ( 30%)
 lexical analysis                   :   0.02 ( 33%)   0.00 (  0%)   0.00 (  0%)     0  (  0%)
 parser struct body                 :   0.00 (  0%)   0.00 (  0%)   0.02 ( 33%)   107k (  3%)
 parser function body               :   0.01 ( 17%)   0.00 (  0%)   0.01 ( 17%)   116k (  3%)
 tree CCP                           :   0.01 ( 17%)   0.00 (  0%)   0.00 (  0%)   960  (  0%)
 TOTAL                              :   0.06          0.00          0.06         3571k
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c: In function ‘foo’:
./benchmarks/openssl/use_after_free_1/openssl_uaf_1.c:271:1: warning: leak of ‘conf_5’ [CWE-401] [-Wanalyzer-malloc-leak]
  271 | }
      | ^
  ‘foo’: events 1-2
    |
    |  259 | void foo()
    |      |      ^
    |      |      |
    |      |      (1) entry to ‘foo’
    |......
    |  262 |     if ((conf = CONF_new()) == NULL)
    |      |                 ~
    |      |                 |
    |      |                 (2) calling ‘CONF_new’ from ‘foo’
    |
    +--> ‘CONF_new’: events 3-4
           |
           |  251 | CONF *CONF_new()
           |      |       ^
           |      |       |
           |      |       (3) entry to ‘CONF_new’
           |......
           |  255 |     ret = OPENSSL_malloc(sizeof(*ret));
           |      |           ~
           |      |           |
           |      |           (4) allocated here
           |
    <------+
    |
  ‘foo’: events 5-9
    |
    |  262 |     if ((conf = CONF_new()) == NULL)
    |      |        ~        ^
    |      |        |        |
    |      |        |        (5) returning to ‘foo’ from ‘CONF_new’
    |      |        (6) assuming ‘conf_5’ is non-NULL
    |      |        (7) following ‘false’ branch (when ‘conf_5’ is non-NULL)...
    |  263 |         goto end;
    |  264 |     conf->data = NULL;
    |      |                ~ 
    |      |                |
    |      |                (8) ...to here
    |  265 |     if (_CONF_new_data(conf) == 0)
    |      |         ~        
    |      |         |
    |      |         (9) calling ‘_CONF_new_data’ from ‘foo’
    |
    +--> ‘_CONF_new_data’: events 10-15
           |
           |  229 | int _CONF_new_data(CONF *conf)
           |      |     ^
           |      |     |
           |      |     (10) entry to ‘_CONF_new_data’
           |  230 | {
           |  231 |     if (conf == NULL) {
           |      |        ~
           |      |        |
           |      |        (11) following ‘false’ branch (when ‘conf_6(D)’ is non-NULL)...
           |......
           |  234 |     if (conf->data == NULL) {
           |      |        ~    ~
           |      |        |    |
           |      |        |    (12) ...to here
           |      |        (13) following ‘true’ branch...
           |  235 |         conf->data = lh_CONF_VALUE_new();
           |      |                      ~
           |      |                      |
           |      |                      (14) ...to here
           |  236 |         if (conf->data == NULL)
           |      |            ~
           |      |            |
           |      |            (15) following ‘true’ branch...
           |
         ‘_CONF_new_data’: event 16
           |
           |lto1:
           | (16): ...to here
           |
    <------+
    |
  ‘foo’: events 17-20
    |
    |  265 |     if (_CONF_new_data(conf) == 0)
    |      |        ~^
    |      |        ||
    |      |        |(17) returning to ‘foo’ from ‘_CONF_new_data’
    |      |        (18) following ‘true’ branch...
    |  266 |                 goto end;
    |      |                 ~
    |      |                 |
    |      |                 (19) ...to here
    |......
    |  270 |     CONF_free(conf);
    |      |     ~    
    |      |     |
    |      |     (20) calling ‘CONF_free’ from ‘foo’
    |
    +--> ‘CONF_free’: events 21-24
           |
           |  242 | void CONF_free(CONF *conf)
           |      |      ^
           |      |      |
           |      |      (21) entry to ‘CONF_free’
           |  243 | {
           |  244 |     if (conf == NULL || conf->data == NULL)
           |      |        ~             ~      ~
           |      |        |             |      |
           |      |        |             |      (23) ...to here
           |      |        |             (24) following ‘true’ branch...
           |      |        (22) following ‘false’ branch (when ‘conf_4(D)’ is non-NULL)...
           |
         ‘CONF_free’: event 25
           |
           |lto1:
           | (25): ...to here
           |
    <------+
    |
  ‘foo’: events 26-27
    |
    |  270 |     CONF_free(conf);
    |      |     ^
    |      |     |
    |      |     (26) returning to ‘foo’ from ‘CONF_free’
    |  271 | }
    |      | ~    
    |      | |
    |      | (27) ‘conf_5’ leaks here; was allocated at (4)
    |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 91%)
 phase opt and generate             :   0.10 (100%)   0.01 (100%)   0.11 (100%)   142k (  6%)
 analyzer                           :   0.01 ( 10%)   0.00 (  0%)   0.01 (  9%)     0  (  0%)
 analyzer: supergraph               :   0.00 (  0%)   0.00 (  0%)   0.01 (  9%)     0  (  0%)
 analyzer: processing worklist      :   0.09 ( 90%)   0.01 (100%)   0.09 ( 82%)   504  (  0%)
 TOTAL                              :   0.10          0.01          0.11         2365k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 69%)
 phase opt and generate             :   0.04 (100%)   0.00 (  0%)   0.04 (100%)   923k ( 29%)
 dump files                         :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)     0  (  0%)
 callgraph functions expansion      :   0.04 (100%)   0.00 (  0%)   0.04 (100%)   760k ( 24%)
 tree linearize phis                :   0.02 ( 50%)   0.00 (  0%)   0.00 (  0%)    15k (  0%)
 tree modref                        :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)  4128  (  0%)
 expand                             :   0.01 ( 25%)   0.00 (  0%)   0.00 (  0%)    75k (  2%)
 LRA non-specific                   :   0.00 (  0%)   0.00 (  0%)   0.01 ( 25%)  2872  (  0%)
 initialize rtl                     :   0.01 ( 25%)   0.00 (  0%)   0.01 ( 25%)    12k (  0%)
 TOTAL                              :   0.04          0.00          0.04         3141k
/usr/bin/ld: /tmp/ccPLlABz.ltrans0.ltrans.o: in function `app_RAND_write':
<artificial>:(.text+0x348): undefined reference to `RAND_write_file'
collect2: error: ld returned 1 exit status
