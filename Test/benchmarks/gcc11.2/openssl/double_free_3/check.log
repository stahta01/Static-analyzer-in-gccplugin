./benchmarks/openssl/double_free_3/openssl_df_3.c: In function ‘PACKET_memdup’:
./benchmarks/openssl/double_free_3/openssl_df_3.c:53:14: warning: implicit declaration of function ‘PACKET_remaining’ [-Wimplicit-function-declaration]
   53 |     length = PACKET_remaining(pkt);
      |              ^~~~~~~~~~~~~~~~
In file included from ./benchmarks/openssl/double_free_3/openssl_df_3.c:9:
./benchmarks/openssl/double_free_3/../openssl.h:9:33: warning: implicit declaration of function ‘strdup’ [-Wimplicit-function-declaration]
    9 | #define OPENSSL_memdup(p, size) strdup(p)
      |                                 ^~~~~~
./benchmarks/openssl/double_free_3/openssl_df_3.c:58:13: note: in expansion of macro ‘OPENSSL_memdup’
   58 |     *data = OPENSSL_memdup(pkt->curr, length);  /* allocation site */
      |             ^~~~~~~~~~~~~~
./benchmarks/openssl/double_free_3/../openssl.h:9:33: warning: incompatible implicit declaration of built-in function ‘strdup’ [-Wbuiltin-declaration-mismatch]
    9 | #define OPENSSL_memdup(p, size) strdup(p)
      |                                 ^~~~~~
./benchmarks/openssl/double_free_3/openssl_df_3.c:58:13: note: in expansion of macro ‘OPENSSL_memdup’
   58 |     *data = OPENSSL_memdup(pkt->curr, length);  /* allocation site */
      |             ^~~~~~~~~~~~~~
./benchmarks/openssl/double_free_3/openssl_df_3.c: In function ‘tls_parse_stoc_cookie’:
./benchmarks/openssl/double_free_3/openssl_df_3.c:71:10: warning: implicit declaration of function ‘PACKET_as_length_prefixed_2’ [-Wimplicit-function-declaration]
   71 |     if (!PACKET_as_length_prefixed_2(pkt, &cookie)
      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/double_free_3/openssl_df_3.c: In function ‘tls_construct_ctos_cookie’:
./benchmarks/openssl/double_free_3/openssl_df_3.c:89:10: warning: implicit declaration of function ‘WPACKET_put_bytes_u16’ [-Wimplicit-function-declaration]
   89 |     if (!WPACKET_put_bytes_u16(pkt, 0)
      |          ^~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/double_free_3/openssl_df_3.c:91:17: warning: implicit declaration of function ‘WPACKET_start_sub_packet_u16’ [-Wimplicit-function-declaration]
   91 |             || !WPACKET_start_sub_packet_u16(pkt)
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/double_free_3/openssl_df_3.c:92:17: warning: implicit declaration of function ‘WPACKET_sub_memcpy_u16’ [-Wimplicit-function-declaration]
   92 |             || !WPACKET_sub_memcpy_u16(pkt, s->ext.tls13_cookie,
      |                 ^~~~~~~~~~~~~~~~~~~~~~
./benchmarks/openssl/double_free_3/openssl_df_3.c:94:17: warning: implicit declaration of function ‘WPACKET_close’ [-Wimplicit-function-declaration]
   94 |             || !WPACKET_close(pkt)) {
      |                 ^~~~~~~~~~~~~

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  1298k ( 39%)
 phase parsing                      :   0.10 ( 91%)   0.00 (  0%)   0.11 (100%)  1895k ( 56%)
 phase opt and generate             :   0.01 (  9%)   0.00 (  0%)   0.00 (  0%)   164k (  5%)
 callgraph ipa passes               :   0.01 (  9%)   0.00 (  0%)   0.00 (  0%)    55k (  2%)
 ipa modref                         :   0.01 (  9%)   0.00 (  0%)   0.00 (  0%)  2480  (  0%)
 preprocessing                      :   0.02 ( 18%)   0.00 (  0%)   0.02 ( 18%)  1079k ( 32%)
 lexical analysis                   :   0.00 (  0%)   0.00 (  0%)   0.01 (  9%)     0  (  0%)
 parser (global)                    :   0.01 (  9%)   0.00 (  0%)   0.01 (  9%)   679k ( 20%)
 parser struct body                 :   0.01 (  9%)   0.00 (  0%)   0.00 (  0%)   102k (  3%)
 parser function body               :   0.06 ( 55%)   0.00 (  0%)   0.07 ( 64%)    25k (  1%)
 TOTAL                              :   0.11          0.00          0.11         3369k
./benchmarks/openssl/double_free_3/openssl_df_3.c: In function ‘SSL_free’:
./benchmarks/openssl/double_free_3/openssl_df_3.c:32:5: warning: double-‘free’ of ‘strdup (pkt_14(D)->curr)’ [CWE-415] [-Wanalyzer-double-free]
   32 |     OPENSSL_free(s->ext.tls13_cookie);  /* double-free */
      |     ^
  ‘main’: events 1-2
    |
    |  106 | int main()
    |      |     ^
    |      |     |
    |      |     (1) entry to ‘main’
    |......
    |  115 |     tls_parse_stoc_cookie(s, &pkt, 0, NULL, 0, NULL);
    |      |     ~
    |      |     |
    |      |     (2) calling ‘tls_parse_stoc_cookie’ from ‘main’
    |
    +--> ‘tls_parse_stoc_cookie’: events 3-6
           |
           |   66 | int tls_parse_stoc_cookie(SSL *s, PACKET *pkt, unsigned int context, X509 *x,
           |      |     ^
           |      |     |
           |      |     (3) entry to ‘tls_parse_stoc_cookie’
           |......
           |   71 |     if (!PACKET_as_length_prefixed_2(pkt, &cookie)
           |      |        ~
           |      |        |
           |      |        (4) following ‘false’ branch...
           |   72 |             || !PACKET_memdup(&cookie, &s->ext.tls13_cookie,
           |      |                 ~
           |      |                 |
           |      |                 (5) ...to here
           |      |                 (6) calling ‘PACKET_memdup’ from ‘tls_parse_stoc_cookie’
           |
           +--> ‘PACKET_memdup’: events 7-13
                  |
                  |   45 | int PACKET_memdup(const PACKET *pkt, unsigned char **data, size_t *len)
                  |      |     ^
                  |      |     |
                  |      |     (7) entry to ‘PACKET_memdup’
                  |......
                  |   55 |     if (length == 0)
                  |      |        ~
                  |      |        |
                  |      |        (8) following ‘false’ branch (when ‘length_16 != 0’)...
                  |......
                  |   58 |     *data = OPENSSL_memdup(pkt->curr, length);  /* allocation site */
                  |      |             ~
                  |      |             |
                  |      |             (9) ...to here
                  |      |             (10) allocated here
                  |   59 |     if (*data == NULL)
                  |      |        ~
                  |      |        |
                  |      |        (11) assuming ‘strdup (pkt_14(D)->curr)’ is non-NULL
                  |      |        (12) following ‘false’ branch...
                  |......
                  |   62 |     *len = length;
                  |      |          ~
                  |      |          |
                  |      |          (13) ...to here
                  |
           <------+
           |
         ‘tls_parse_stoc_cookie’: events 14-15
           |
           |   72 |             || !PACKET_memdup(&cookie, &s->ext.tls13_cookie,
           |      |             ~   ^
           |      |             |   |
           |      |             |   (14) returning to ‘tls_parse_stoc_cookie’ from ‘PACKET_memdup’
           |      |             (15) following ‘false’ branch...
           |
         ‘tls_parse_stoc_cookie’: event 16
           |
           |lto1:
           | (16): ...to here
           |
    <------+
    |
  ‘main’: events 17-18
    |
    |  115 |     tls_parse_stoc_cookie(s, &pkt, 0, NULL, 0, NULL);
    |      |     ^
    |      |     |
    |      |     (17) returning to ‘main’ from ‘tls_parse_stoc_cookie’
    |  116 |     tls_construct_ctos_cookie(s, NULL, 0, NULL, 0, NULL);
    |      |     ~
    |      |     |
    |      |     (18) calling ‘tls_construct_ctos_cookie’ from ‘main’
    |
    +--> ‘tls_construct_ctos_cookie’: events 19-22
           |
           |   80 | int tls_construct_ctos_cookie(SSL *s, WPACKET *pkt, unsigned int context,
           |      |     ^
           |      |     |
           |      |     (19) entry to ‘tls_construct_ctos_cookie’
           |......
           |   86 |     if (s->ext.tls13_cookie_len == 0)
           |      |        ~
           |      |        |
           |      |        (20) following ‘false’ branch...
           |......
           |   89 |     if (!WPACKET_put_bytes_u16(pkt, 0)
           |      |          ~
           |      |          |
           |      |          (21) ...to here
           |......
           |  100 |     OPENSSL_free(s->ext.tls13_cookie);  /* freed */
           |      |     ~
           |      |     |
           |      |     (22) first ‘free’ here
           |
    <------+
    |
  ‘main’: events 23-24
    |
    |  116 |     tls_construct_ctos_cookie(s, NULL, 0, NULL, 0, NULL);
    |      |     ^
    |      |     |
    |      |     (23) returning to ‘main’ from ‘tls_construct_ctos_cookie’
    |  117 | 
    |  118 |     SSL_free(s);
    |      |     ~
    |      |     |
    |      |     (24) calling ‘SSL_free’ from ‘main’
    |
    +--> ‘SSL_free’: events 25-28
           |
           |   27 | void SSL_free(SSL *s)
           |      |      ^
           |      |      |
           |      |      (25) entry to ‘SSL_free’
           |   28 | {
           |   29 |     if (s == NULL)
           |      |        ~
           |      |        |
           |      |        (26) following ‘false’ branch (when ‘s_3(D)’ is non-NULL)...
           |......
           |   32 |     OPENSSL_free(s->ext.tls13_cookie);  /* double-free */
           |      |     ~ 
           |      |     |
           |      |     (27) ...to here
           |      |     (28) second ‘free’ here; first ‘free’ was at (22)
           |

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 95%)
 phase opt and generate             :   0.01 (100%)   0.01 (100%)   0.02 (100%)    66k (  3%)
 analyzer                           :   0.00 (  0%)   0.00 (  0%)   0.01 ( 50%)     0  (  0%)
 analyzer: processing worklist      :   0.00 (  0%)   0.00 (  0%)   0.01 ( 50%)   248  (  0%)
 analyzer: emitting diagnostics     :   0.01 (100%)   0.01 (100%)   0.00 (  0%)   728  (  0%)
 TOTAL                              :   0.01          0.01          0.02         2267k

Time variable                                   usr           sys          wall           GGC
 phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.00 (  0%)  2157k ( 85%)
 phase opt and generate             :   0.02 (100%)   0.00 (  0%)   0.02 (100%)   353k ( 14%)
 callgraph functions expansion      :   0.02 (100%)   0.00 (  0%)   0.02 (100%)   279k ( 11%)
 expand                             :   0.00 (  0%)   0.00 (  0%)   0.01 ( 50%)    31k (  1%)
 combiner                           :   0.01 ( 50%)   0.00 (  0%)   0.00 (  0%)  4512  (  0%)
 initialize rtl                     :   0.01 ( 50%)   0.00 (  0%)   0.01 ( 50%)    12k (  0%)
 TOTAL                              :   0.02          0.00          0.02         2551k
/usr/bin/ld: /tmp/ccjbjHNF.ltrans0.ltrans.o: in function `PACKET_memdup':
<artificial>:(.text+0x4f): undefined reference to `PACKET_remaining'
/usr/bin/ld: /tmp/ccjbjHNF.ltrans0.ltrans.o: in function `tls_parse_stoc_cookie':
<artificial>:(.text+0xa2): undefined reference to `PACKET_as_length_prefixed_2'
/usr/bin/ld: /tmp/ccjbjHNF.ltrans0.ltrans.o: in function `tls_construct_ctos_cookie':
<artificial>:(.text+0xf4): undefined reference to `WPACKET_put_bytes_u16'
/usr/bin/ld: <artificial>:(.text+0x11a): undefined reference to `WPACKET_start_sub_packet_u16'
/usr/bin/ld: <artificial>:(.text+0x135): undefined reference to `WPACKET_sub_memcpy_u16'
/usr/bin/ld: <artificial>:(.text+0x148): undefined reference to `WPACKET_close'
collect2: error: ld returned 1 exit status
