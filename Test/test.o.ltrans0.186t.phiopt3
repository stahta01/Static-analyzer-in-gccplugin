
;; Function update_krl_from_file (update_krl_from_file, funcdef_no=0, decl_uid=3998, cgraph_uid=1, symbol_order=43)

update_krl_from_file (struct passwd * pw, const char * file)
{
  int D.4121;
  static const char __func__[18] = "read_keyfile_line";
  const size_t srclen;
  const size_t dstlen;
  size_t D.4108;
  const char * path;
  char user[128];
  char ret[64];
  u_int slash;
  char * D.4091;
  const char * filename;
  struct FILE * krl_spec;
  char * path;
  u_long lnum;
  int _1;
  unsigned int _2;
  int _3;
  int _5;
  int _6;
  int _8;
  int _34;
  int _35;
  int _36;
  char _57;
  char * _58;
  _Bool _61;
  _Bool _62;
  _Bool _63;
  long int _64;
  long int _65;
  long int _66;
  int _68;
  long int _69;
  long unsigned int _70;
  int _74;
  char * _75;
  char * _76;
  int _78;
  long unsigned int _80;
  long unsigned int _81;
  long unsigned int _82;
  char * _83;
  char * _85;
  long unsigned int _86;
  sizetype _87;
  char * _88;
  long unsigned int _89;
  long unsigned int _90;
  long unsigned int _92;
  int _94;
  int _95;
  int _96;
  int _97;
  int _98;

  <bb 2> [1.09%]:
  _1 = pw_16(D)->pw_uid;
  _2 = (unsigned int) _1;
  _57 = *file_17(D);
  if (_57 != 126)
    goto <bb 3>; [44.89%]
  else
    goto <bb 4>; [55.11%]

  <bb 3> [0.49%]:
  _58 = strdup (file_17(D));
  goto <bb 19>; [100.00%]

  <bb 4> [0.60%]:
  filename_59 = file_17(D) + 1;
  path_60 = strchr (filename_59, 47);
  _61 = path_60 != 0B;
  _62 = filename_59 < path_60;
  _63 = _61 & _62;
  if (_63 != 0)
    goto <bb 5>; [50.00%]
  else
    goto <bb 8>; [50.00%]

  <bb 5> [0.30%]:
  _64 = (long int) path_60;
  _65 = (long int) filename_59;
  _66 = _64 - _65;
  slash_67 = (u_int) _66;
  if (slash_67 > 127)
    goto <bb 6>; [0.04%]
  else
    goto <bb 7>; [99.96%]

  <bb 6> [0.00%]:
  _68 = __printf_chk (1, "tilde_expand_filename: ~username too long%s\n", "");
  exit (1);

  <bb 7> [0.30%]:
  _69 = _66 & 4294967295;
  _70 = (long unsigned int) _69;
  memcpy (&user, filename_59, _70);
  user[slash_67] = 0;

  <bb 8> [0.60%]:
  if (path_60 != 0B)
    goto <bb 9>; [70.00%]
  else
    goto <bb 10>; [30.00%]

  <bb 9> [0.42%]:
  filename_71 = path_60 + 1;

  <bb 10> [0.60%]:
  # filename_72 = PHI <filename_59(8), filename_71(9)>
  srclen_77 = strlen (filename_72);
  _78 = strnlen (&ret, 64);
  dstlen_79 = (const size_t) _78;
  if (dstlen_79 == 64)
    goto <bb 11>; [30.50%]
  else
    goto <bb 12>; [69.50%]

  <bb 11> [0.18%]:
  _80 = srclen_77 + 64;
  goto <bb 16>; [100.00%]

  <bb 12> [0.42%]:
  _81 = 64 - dstlen_79;
  if (srclen_77 < _81)
    goto <bb 13>; [50.00%]
  else
    goto <bb 14>; [50.00%]

  <bb 13> [0.21%]:
  _82 = srclen_77 + 1;
  _83 = &ret + dstlen_79;
  memcpy (_83, filename_72, _82);
  goto <bb 15>; [100.00%]

  <bb 14> [0.21%]:
  _85 = &ret + dstlen_79;
  memcpy (_85, filename_72, 63);
  _86 = dstlen_79 + 64;
  _87 = dstlen_79 + 63;
  _88 = &ret + _87;
  *_88 = 0;

  <bb 15> [0.42%]:
  _89 = srclen_77 + dstlen_79;

  <bb 16> [0.60%]:
  # _90 = PHI <_80(11), _89(15)>
  if (_90 > 63)
    goto <bb 17>; [0.04%]
  else
    goto <bb 18>; [99.96%]

  <bb 17> [0.00%]:
  _74 = __printf_chk (1, "tilde_expand_filename: Path too long%s\n", "");
  exit (1);

  <bb 18> [0.60%]:
  _75 = strdup (&ret);

  <bb 19> [1.09%]:
  # _76 = PHI <_58(3), _75(18)>
  user ={v} {CLOBBER};
  ret ={v} {CLOBBER};
  _3 = strcmp (_76, "-");
  if (_3 == 0)
    goto <bb 20>; [50.00%]
  else
    goto <bb 21>; [50.00%]

  <bb 20> [0.54%]:
  krl_spec_23 = stdin;
  free (_76);
  path_26 = strdup ("(standard input)");
  goto <bb 23>; [100.00%]

  <bb 21> [0.54%]:
  krl_spec_21 = fopen (_76, "r");
  if (krl_spec_21 == 0B)
    goto <bb 22>; [0.04%]
  else
    goto <bb 23>; [99.96%]

  <bb 22> [0.00%]:
  _34 = __printf_chk (1, "fopen %s: \n", _76);
  exit (1);

  <bb 23> [1.09%]:
  # path_9 = PHI <path_26(20), _76(21)>
  # krl_spec_10 = PHI <krl_spec_23(20), krl_spec_21(21)>
  _35 = __printf_chk (1, "Revoking from %s\n", path_9);
  goto <bb 25>; [100.00%]

  <bb 24> [0.01%]:
  _36 = __printf_chk (1, "%s: invalid\n", path_9);
  exit (1);

  <bb 25> [14.44%]:
  # lnum_127 = PHI <_92(31), 0(23)>
  goto <bb 27>; [100.00%]

  <bb 26> [92.50%]:
  _92 = lnum_128 + 1;
  _94 = __printf_chk (1, "%s: %s line %lu exceeds size limit\n", &__func__, path_9, _92);
  _95 = rand ();
  _96 = _95 % 2;
  if (_96 == 1)
    goto <bb 31>; [7.50%]
  else
    goto <bb 27>; [92.50%]

  <bb 27> [100.00%]:
  # lnum_128 = PHI <lnum_127(25), _92(26)>
  _97 = rand ();
  _98 = _97 % 2;
  if (_98 == 1)
    goto <bb 26>; [92.50%]
  else
    goto <bb 30>; [7.50%]

  <bb 28> [0.40%]:
  fclose (krl_spec_10);

  <bb 29> [1.08%]:
  return;

  <bb 30> [7.50%]:
  _8 = strcmp (path_9, "-");
  if (_8 != 0)
    goto <bb 28>; [36.64%]
  else
    goto <bb 29>; [63.36%]

  <bb 31> [13.35%]:
  _5 = rand ();
  _6 = _5 % 2;
  if (_6 == 1)
    goto <bb 24>; [0.04%]
  else
    goto <bb 25>; [99.96%]

}



;; Function main (main, funcdef_no=4, decl_uid=3986, cgraph_uid=0, symbol_order=44) (executed once)

main (int argc, char * * argv)
{
  unsigned long ivtmp.8;
  int i;
  struct passwd pw;
  int _1;
  unsigned int _2;
  char * _6;
  void * _23;
  unsigned long _25;
  unsigned int _28;
  unsigned int _29;
  unsigned long _30;
  unsigned long _31;
  unsigned long _32;
  unsigned long _34;

  <bb 2> [15.00%]:
  _1 = time (0B);
  _2 = (unsigned int) _1;
  srand (_2);
  if (argc_12(D) > 0)
    goto <bb 3>; [85.00%]
  else
    goto <bb 5>; [15.00%]

  <bb 3> [12.75%]:
  ivtmp.8_24 = (unsigned long) argv_14(D);
  _28 = (unsigned int) argc_12(D);
  _29 = _28 + 4294967295;
  _30 = (unsigned long) _29;
  _31 = _30 * 8;
  _32 = ivtmp.8_24;
  _25 = ivtmp.8_24 + 8;
  _34 = _25 + _31;

  <bb 4> [85.00%]:
  # ivtmp.8_17 = PHI <ivtmp.8_7(4), ivtmp.8_24(3)>
  _23 = (void *) ivtmp.8_17;
  _6 = MEM[base: _23, offset: 0B];
  update_krl_from_file (&pw, _6);
  ivtmp.8_7 = ivtmp.8_17 + 8;
  if (ivtmp.8_7 != _34)
    goto <bb 4>; [85.00%]
  else
    goto <bb 5>; [15.00%]

  <bb 5> [15.00%]:
  pw ={v} {CLOBBER};
  return 0;

}


