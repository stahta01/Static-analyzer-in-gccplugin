
;; Function EVP_PKEY_CTX_free (EVP_PKEY_CTX_free, funcdef_no=22, decl_uid=3856, cgraph_uid=23, symbol_order=24)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8
;; 2 succs { 3 4 }
;; 3 succs { 8 }
;; 4 succs { 5 7 }
;; 5 succs { 6 7 }
;; 6 succs { 7 }
;; 7 succs { 8 }
;; 8 succs { 1 }
void EVP_PKEY_CTX_free (struct EVP_PKEY_CTX * ctx)
{
  <bb 2> :
  if (ctx == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 8>; [INV]

  <bb 4> :
  _1 = ctx->pmeth;
  if (_1 != 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 5> :
  _2 = ctx->pmeth;
  _3 = _2->cleanup;
  if (_3 != 0B)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  _4 = ctx->pmeth;
  _5 = _4->cleanup;
  _5 (ctx);

  <bb 7> :
  _6 = ctx->pkey;
  EVP_PKEY_free (_6);
  _7 = ctx->peerkey;
  EVP_PKEY_free (_7);
  _8 = ctx->engine;
  ENGINE_finish (_8);
  free (ctx);

  <bb 8> :
  return;

}



;; Function init_gen_str (init_gen_str, funcdef_no=24, decl_uid=3887, cgraph_uid=25, symbol_order=26)

Removing basic block 13
Merging blocks 18 and 19
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17
;; 2 succs { 3 4 }
;; 3 succs { 17 }
;; 4 succs { 5 6 }
;; 5 succs { 6 }
;; 6 succs { 7 8 }
;; 7 succs { 17 }
;; 8 succs { 9 10 }
;; 9 succs { 16 }
;; 10 succs { 11 13 }
;; 11 succs { 12 15 }
;; 12 succs { 16 }
;; 13 succs { 14 15 }
;; 14 succs { 16 }
;; 15 succs { 17 }
;; 16 succs { 17 }
;; 17 succs { 1 }
int init_gen_str (struct EVP_PKEY_CTX * * pctx, const char * algname, struct ENGINE * e, int do_param)
{
  int pkey_id;
  struct ENGINE * tmpeng;
  const struct EVP_PKEY_ASN1_METHOD * ameth;
  struct EVP_PKEY_CTX * ctx;
  int D.4070;

  <bb 2> :
  ctx = 0B;
  tmpeng = 0B;
  _1 = *pctx;
  if (_1 != 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  D.4070 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 4> :
  _2 = EVP_PKEY_asn1_find_str (&tmpeng, algname, -1);
  _3 = (long int) _2;
  ameth = (const struct EVP_PKEY_ASN1_METHOD *) _3;
  _4 = ameth == 0B;
  _5 = e != 0B;
  _6 = _4 & _5;
  if (_6 != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  _7 = ENGINE_get_pkey_asn1_meth_str (e, algname, -1);
  _8 = (long int) _7;
  ameth = (const struct EVP_PKEY_ASN1_METHOD *) _8;

  <bb 6> :
  if (ameth == 0B)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  D.4070 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 8> :
  ERR_clear_error ();
  EVP_PKEY_asn1_get0_info (&pkey_id, 0B, 0B, 0B, 0B, ameth);
  tmpeng.0_9 = tmpeng;
  ENGINE_finish (tmpeng.0_9);
  pkey_id.1_10 = pkey_id;
  _11 = EVP_PKEY_CTX_new_id (pkey_id.1_10, e);
  _12 = (long int) _11;
  ctx = (struct EVP_PKEY_CTX *) _12;
  if (ctx == 0B)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  // predicted unlikely by goto predictor.
  goto <bb 16>; [INV]

  <bb 10> :
  if (do_param != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 11> :
  _13 = EVP_PKEY_paramgen_init (ctx);
  if (_13 <= 0)
    goto <bb 12>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 12> :
  // predicted unlikely by goto predictor.
  goto <bb 16>; [INV]

  <bb 13> :
  _14 = EVP_PKEY_keygen_init (ctx);
  if (_14 <= 0)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  // predicted unlikely by goto predictor.
  goto <bb 16>; [INV]

  <bb 15> :
  *pctx = ctx;
  D.4070 = 1;
  goto <bb 17>; [INV]

  <bb 16> :
err:
  bio_err.2_15 = bio_err;
  BIO_printf (bio_err.2_15, "Error initializing %s context\n", algname);
  bio_err.3_16 = bio_err;
  ERR_print_errors (bio_err.3_16);
  EVP_PKEY_CTX_free (ctx);
  D.4070 = 0;

  <bb 17> :
  tmpeng = {CLOBBER};
  pkey_id = {CLOBBER};
  return D.4070;

}



;; Function EVP_PKEY_CTX_new (EVP_PKEY_CTX_new, funcdef_no=25, decl_uid=3915, cgraph_uid=26, symbol_order=27)

Merging blocks 2 and 3
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2
;; 2 succs { 1 }
struct EVP_PKEY_CTX * EVP_PKEY_CTX_new (struct EVP_PKEY * pkey, struct ENGINE * e)
{
  struct EVP_PKEY_CTX * D.4086;

  <bb 2> :
  D.4086 = int_ctx_new (pkey, e, -1);
  return D.4086;

}



;; Function int_ctx_new (int_ctx_new, funcdef_no=23, decl_uid=3865, cgraph_uid=24, symbol_order=25)

Removing basic block 12
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26
;; 2 succs { 3 7 }
;; 3 succs { 5 4 }
;; 4 succs { 5 6 }
;; 5 succs { 26 }
;; 6 succs { 7 }
;; 7 succs { 8 9 }
;; 8 succs { 9 }
;; 9 succs { 10 12 }
;; 10 succs { 11 13 }
;; 11 succs { 26 }
;; 12 succs { 13 }
;; 13 succs { 14 15 }
;; 14 succs { 16 }
;; 15 succs { 16 }
;; 16 succs { 17 18 }
;; 17 succs { 26 }
;; 18 succs { 19 20 }
;; 19 succs { 26 }
;; 20 succs { 21 22 }
;; 21 succs { 22 }
;; 22 succs { 23 25 }
;; 23 succs { 24 25 }
;; 24 succs { 26 }
;; 25 succs { 26 }
;; 26 succs { 1 }
struct EVP_PKEY_CTX * int_ctx_new (struct EVP_PKEY * pkey, struct ENGINE * e, int id)
{
  const struct EVP_PKEY_METHOD * pmeth;
  struct EVP_PKEY_CTX * ret;
  struct EVP_PKEY_CTX * D.4093;

  <bb 2> :
  if (id == -1)
    goto <bb 3>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 3> :
  if (pkey == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 4> :
  _1 = pkey->ameth;
  if (_1 == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  D.4093 = 0B;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 26>; [INV]

  <bb 6> :
  _2 = pkey->ameth;
  id = _2->pkey_id;

  <bb 7> :
  _3 = e == 0B;
  _4 = pkey != 0B;
  _5 = _3 & _4;
  if (_5 != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  e = pkey->engine;

  <bb 9> :
  if (e != 0B)
    goto <bb 10>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 10> :
  _6 = ENGINE_init (e);
  if (_6 == 0)
    goto <bb 11>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 11> :
  D.4093 = 0B;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 26>; [INV]

  <bb 12> :
  _7 = ENGINE_get_pkey_meth_engine (id);
  _8 = (long int) _7;
  e = (struct ENGINE *) _8;

  <bb 13> :
  if (e != 0B)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  _9 = ENGINE_get_pkey_meth (e, id);
  _10 = (long int) _9;
  pmeth = (const struct EVP_PKEY_METHOD *) _10;
  goto <bb 16>; [INV]

  <bb 15> :
  _11 = EVP_PKEY_meth_find (id);
  _12 = (long int) _11;
  pmeth = (const struct EVP_PKEY_METHOD *) _12;

  <bb 16> :
  if (pmeth == 0B)
    goto <bb 17>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 17> :
  EVPerr (157, 156);
  D.4093 = 0B;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 26>; [INV]

  <bb 18> :
  ret = malloc (80);
  if (ret == 0B)
    goto <bb 19>; [INV]
  else
    goto <bb 20>; [INV]

  <bb 19> :
  ENGINE_finish (e);
  EVPerr (157, 65);
  D.4093 = 0B;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 26>; [INV]

  <bb 20> :
  ret->engine = e;
  ret->pmeth = pmeth;
  ret->operation = 0;
  ret->pkey = pkey;
  if (pkey != 0B)
    goto <bb 21>; [INV]
  else
    goto <bb 22>; [INV]

  <bb 21> :
  EVP_PKEY_up_ref (pkey);

  <bb 22> :
  _13 = pmeth->init;
  if (_13 != 0B)
    goto <bb 23>; [INV]
  else
    goto <bb 25>; [INV]

  <bb 23> :
  _14 = pmeth->init;
  _15 = _14 (ret);
  if (_15 <= 0)
    goto <bb 24>; [INV]
  else
    goto <bb 25>; [INV]

  <bb 24> :
  ret->pmeth = 0B;
  EVP_PKEY_CTX_free (ret);
  D.4093 = 0B;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 26>; [INV]

  <bb 25> :
  D.4093 = ret;

  <bb 26> :
  return D.4093;

}



;; Function EVP_PKEY_CTX_new_id (EVP_PKEY_CTX_new_id, funcdef_no=26, decl_uid=3919, cgraph_uid=27, symbol_order=28)

Merging blocks 2 and 3
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2
;; 2 succs { 1 }
struct EVP_PKEY_CTX * EVP_PKEY_CTX_new_id (int id, struct ENGINE * e)
{
  struct EVP_PKEY_CTX * D.4115;

  <bb 2> :
  D.4115 = int_ctx_new (0B, e, id);
  return D.4115;

}



;; Function genpkey_main (genpkey_main, funcdef_no=29, decl_uid=3960, cgraph_uid=30, symbol_order=31)

Removing basic block 8
Removing basic block 16
Removing basic block 19
Removing basic block 24
Removing basic block 44
Merging blocks 63 and 64
Merging blocks 63 and 65
;; 2 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58
;;
;; Loop 1
;;  header 28, multiple latches: 3 6 8 9 10 13 15 19 23 24 26
;;  depth 1, outer 0
;;  nodes: 28 3 6 8 9 10 13 15 19 23 24 26 25 21 17 11
;; 2 succs { 28 }
;; 3 succs { 28 4 5 10 6 8 9 11 15 17 21 24 25 }
;; 4 succs { 58 }
;; 5 succs { 58 }
;; 6 succs { 7 28 }
;; 7 succs { 4 }
;; 8 succs { 28 }
;; 9 succs { 28 }
;; 10 succs { 28 }
;; 11 succs { 12 13 }
;; 12 succs { 4 }
;; 13 succs { 14 28 }
;; 14 succs { 58 }
;; 15 succs { 16 28 }
;; 16 succs { 58 }
;; 17 succs { 18 19 }
;; 18 succs { 4 }
;; 19 succs { 20 28 }
;; 20 succs { 58 }
;; 21 succs { 22 23 }
;; 22 succs { 4 }
;; 23 succs { 28 }
;; 24 succs { 28 }
;; 25 succs { 27 26 }
;; 26 succs { 27 28 }
;; 27 succs { 4 }
;; 28 succs { 3 29 }
;; 29 succs { 30 31 }
;; 30 succs { 4 }
;; 31 succs { 32 33 }
;; 32 succs { 4 }
;; 33 succs { 34 35 }
;; 34 succs { 58 }
;; 35 succs { 36 37 }
;; 36 succs { 58 }
;; 37 succs { 38 40 }
;; 38 succs { 39 42 }
;; 39 succs { 58 }
;; 40 succs { 41 42 }
;; 41 succs { 58 }
;; 42 succs { 43 44 }
;; 43 succs { 49 }
;; 44 succs { 45 46 }
;; 45 succs { 49 }
;; 46 succs { 47 48 }
;; 47 succs { 49 }
;; 48 succs { 58 }
;; 49 succs { 50 51 }
;; 50 succs { 51 }
;; 51 succs { 52 57 }
;; 52 succs { 53 54 }
;; 53 succs { 55 }
;; 54 succs { 55 }
;; 55 succs { 56 57 }
;; 56 succs { 57 }
;; 57 succs { 58 }
;; 58 succs { 1 }
int genpkey_main (int argc, char * * argv)
{
  int private;
  int do_param;
  int rv;
  int ret;
  int text;
  int outformat;
  OPTION_CHOICE o;
  const struct EVP_CIPHER * cipher;
  char * prog;
  char * pass;
  char * passarg;
  char * outfile;
  struct EVP_PKEY_CTX * ctx;
  struct EVP_PKEY * pkey;
  struct ENGINE * e;
  struct BIO * out;
  struct BIO * in;
  int D.4168;

  <bb 2> :
  in = 0B;
  out = 0B;
  e = 0B;
  pkey = 0B;
  ctx = 0B;
  outfile = 0B;
  passarg = 0B;
  pass = 0B;
  cipher = 0B;
  outformat = 32773;
  text = 0;
  ret = 1;
  do_param = 0;
  private = 0;
  prog = opt_init (argc, argv, &genpkey_options);
  goto <bb 28>; [INV]

  <bb 3> :
  switch (o) <default: <L31> [INV], case -1 ... 0: opthelp [INV], case 1: <L4> [INV], case 2: <L10> [INV], case 3: <L5> [INV], case 4: <L8> [INV], case 5: <L9> [INV], case 6: <L11> [INV], case 7: <L16> [INV], case 8: <L19> [INV], case 9: <L24> [INV], case 10: <L27> [INV], case 11: <L28> [INV]>

  <bb 4> :
opthelp:
  bio_err.4_1 = bio_err;
  BIO_printf (bio_err.4_1, "%s: Use -help for summary.\n", prog);
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 5> :
<L4>:
  ret = 0;
  opt_help (&genpkey_options);
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 6> :
<L5>:
  _2 = opt_arg ();
  _3 = (long int) _2;
  _4 = (const char *) _3;
  _5 = opt_format (_4, 2, &outformat);
  if (_5 == 0)
    goto <bb 7>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 7> :
  // predicted unlikely by goto predictor.
  goto <bb 4>; [INV]

  <bb 8> :
<L8>:
  _6 = opt_arg ();
  _7 = (long int) _6;
  outfile = (char *) _7;
  goto <bb 28>; [INV]

  <bb 9> :
<L9>:
  _8 = opt_arg ();
  _9 = (long int) _8;
  passarg = (char *) _9;
  goto <bb 28>; [INV]

  <bb 10> :
<L10>:
  _10 = opt_arg ();
  _11 = setup_engine (_10);
  _12 = (long int) _11;
  e = (struct ENGINE *) _12;
  goto <bb 28>; [INV]

  <bb 11> :
<L11>:
  if (do_param == 1)
    goto <bb 12>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 12> :
  // predicted unlikely by goto predictor.
  goto <bb 4>; [INV]

  <bb 13> :
  _13 = opt_arg ();
  _14 = (long int) _13;
  _15 = (const char *) _14;
  _16 = init_keygen_file (&ctx, _15, e);
  if (_16 == 0)
    goto <bb 14>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 14> :
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 15> :
<L16>:
  _17 = opt_arg ();
  _18 = (long int) _17;
  _19 = (const char *) _18;
  _20 = init_gen_str (&ctx, _19, e, do_param);
  if (_20 == 0)
    goto <bb 16>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 16> :
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 17> :
<L19>:
  ctx.5_21 = ctx;
  if (ctx.5_21 == 0B)
    goto <bb 18>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 18> :
  bio_err.6_22 = bio_err;
  BIO_printf (bio_err.6_22, "%s: No keytype specified.\n", prog);
  // predicted unlikely by goto predictor.
  goto <bb 4>; [INV]

  <bb 19> :
  _23 = opt_arg ();
  ctx.7_24 = ctx;
  _25 = pkey_ctrl_string (ctx.7_24, _23);
  if (_25 <= 0)
    goto <bb 20>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 20> :
  _26 = opt_arg ();
  bio_err.8_27 = bio_err;
  BIO_printf (bio_err.8_27, "%s: Error setting %s parameter:\n", prog, _26);
  bio_err.9_28 = bio_err;
  ERR_print_errors (bio_err.9_28);
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 21> :
<L24>:
  ctx.10_29 = ctx;
  if (ctx.10_29 != 0B)
    goto <bb 22>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 22> :
  // predicted unlikely by goto predictor.
  goto <bb 4>; [INV]

  <bb 23> :
  do_param = 1;
  goto <bb 28>; [INV]

  <bb 24> :
<L27>:
  text = 1;
  goto <bb 28>; [INV]

  <bb 25> :
<L28>:
  _30 = opt_unknown ();
  _31 = opt_cipher (_30, &cipher);
  if (_31 == 0)
    goto <bb 27>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 26> :
  if (do_param == 1)
    goto <bb 27>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 27> :
  // predicted unlikely by goto predictor.
  goto <bb 4>; [INV]

  <bb 28> :
<L31>:
  o = opt_next ();
  if (o != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 29>; [INV]

  <bb 29> :
  argc = opt_num_rest ();
  if (argc != 0)
    goto <bb 30>; [INV]
  else
    goto <bb 31>; [INV]

  <bb 30> :
  // predicted unlikely by goto predictor.
  goto <bb 4>; [INV]

  <bb 31> :
  _32 = do_param == 0;
  private = (int) _32;
  ctx.11_33 = ctx;
  if (ctx.11_33 == 0B)
    goto <bb 32>; [INV]
  else
    goto <bb 33>; [INV]

  <bb 32> :
  // predicted unlikely by goto predictor.
  goto <bb 4>; [INV]

  <bb 33> :
  _34 = app_passwd (passarg, 0B, &pass, 0B);
  if (_34 == 0)
    goto <bb 34>; [INV]
  else
    goto <bb 35>; [INV]

  <bb 34> :
  bio_err.12_35 = bio_err;
  BIO_puts (bio_err.12_35, "Error getting password\n");
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 35> :
  outformat.13_36 = outformat;
  _37 = bio_open_owner (outfile, outformat.13_36, private);
  _38 = (long int) _37;
  out = (struct BIO *) _38;
  if (out == 0B)
    goto <bb 36>; [INV]
  else
    goto <bb 37>; [INV]

  <bb 36> :
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 37> :
  ctx.14_39 = ctx;
  EVP_PKEY_CTX_set_cb (ctx.14_39, genpkey_cb);
  bio_err.15_40 = bio_err;
  ctx.16_41 = ctx;
  EVP_PKEY_CTX_set_app_data (ctx.16_41, bio_err.15_40);
  if (do_param != 0)
    goto <bb 38>; [INV]
  else
    goto <bb 40>; [INV]

  <bb 38> :
  ctx.17_42 = ctx;
  _43 = EVP_PKEY_paramgen (ctx.17_42, &pkey);
  if (_43 <= 0)
    goto <bb 39>; [INV]
  else
    goto <bb 42>; [INV]

  <bb 39> :
  bio_err.18_44 = bio_err;
  BIO_puts (bio_err.18_44, "Error generating parameters\n");
  bio_err.19_45 = bio_err;
  ERR_print_errors (bio_err.19_45);
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 40> :
  ctx.20_46 = ctx;
  _47 = EVP_PKEY_keygen (ctx.20_46, &pkey);
  if (_47 <= 0)
    goto <bb 41>; [INV]
  else
    goto <bb 42>; [INV]

  <bb 41> :
  bio_err.21_48 = bio_err;
  BIO_puts (bio_err.21_48, "Error generating key\n");
  bio_err.22_49 = bio_err;
  ERR_print_errors (bio_err.22_49);
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 42> :
  if (do_param != 0)
    goto <bb 43>; [INV]
  else
    goto <bb 44>; [INV]

  <bb 43> :
  pkey.23_50 = pkey;
  rv = PEM_write_bio_Parameters (out, pkey.23_50);
  goto <bb 49>; [INV]

  <bb 44> :
  outformat.24_51 = outformat;
  if (outformat.24_51 == 32773)
    goto <bb 45>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 45> :
  assert (private);
  pass.25_52 = pass;
  cipher.26_53 = cipher;
  pkey.27_54 = pkey;
  rv = PEM_write_bio_PrivateKey (out, pkey.27_54, cipher.26_53, 0B, 0, 0B, pass.25_52);
  goto <bb 49>; [INV]

  <bb 46> :
  outformat.28_55 = outformat;
  if (outformat.28_55 == 4)
    goto <bb 47>; [INV]
  else
    goto <bb 48>; [INV]

  <bb 47> :
  assert (private);
  pkey.29_56 = pkey;
  rv = i2d_PrivateKey_bio (out, pkey.29_56);
  goto <bb 49>; [INV]

  <bb 48> :
  bio_err.30_57 = bio_err;
  BIO_printf (bio_err.30_57, "Bad format specified for key\n");
  // predicted unlikely by goto predictor.
  goto <bb 58>; [INV]

  <bb 49> :
  if (rv <= 0)
    goto <bb 50>; [INV]
  else
    goto <bb 51>; [INV]

  <bb 50> :
  bio_err.31_58 = bio_err;
  BIO_puts (bio_err.31_58, "Error writing key\n");
  bio_err.32_59 = bio_err;
  ERR_print_errors (bio_err.32_59);

  <bb 51> :
  if (text != 0)
    goto <bb 52>; [INV]
  else
    goto <bb 57>; [INV]

  <bb 52> :
  if (do_param != 0)
    goto <bb 53>; [INV]
  else
    goto <bb 54>; [INV]

  <bb 53> :
  pkey.33_60 = pkey;
  rv = EVP_PKEY_print_params (out, pkey.33_60, 0, 0B);
  goto <bb 55>; [INV]

  <bb 54> :
  pkey.34_61 = pkey;
  rv = EVP_PKEY_print_private (out, pkey.34_61, 0, 0B);

  <bb 55> :
  if (rv <= 0)
    goto <bb 56>; [INV]
  else
    goto <bb 57>; [INV]

  <bb 56> :
  bio_err.35_62 = bio_err;
  BIO_puts (bio_err.35_62, "Error printing key\n");
  bio_err.36_63 = bio_err;
  ERR_print_errors (bio_err.36_63);

  <bb 57> :
  ret = 0;

  <bb 58> :
end:
  pkey.37_64 = pkey;
  EVP_PKEY_free (pkey.37_64);
  ctx.38_65 = ctx;
  EVP_PKEY_CTX_free (ctx.38_65);
  BIO_free_all (out);
  BIO_free (in);
  release_engine (e);
  pass.39_66 = pass;
  free (pass.39_66);
  D.4168 = ret;
  pkey = {CLOBBER};
  ctx = {CLOBBER};
  pass = {CLOBBER};
  cipher = {CLOBBER};
  outformat = {CLOBBER};
  return D.4168;

}



;; Function genpkey_cb (genpkey_cb, funcdef_no=28, decl_uid=3945, cgraph_uid=29, symbol_order=30)

Merging blocks 10 and 11
Merging blocks 10 and 12
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10
;; 2 succs { 3 4 }
;; 3 succs { 4 }
;; 4 succs { 5 6 }
;; 5 succs { 6 }
;; 6 succs { 7 8 }
;; 7 succs { 8 }
;; 8 succs { 9 10 }
;; 9 succs { 10 }
;; 10 succs { 1 }
int genpkey_cb (struct EVP_PKEY_CTX * ctx)
{
  int p;
  struct BIO * b;
  char c;
  int D.4179;

  <bb 2> :
  c = 42;
  _1 = EVP_PKEY_CTX_get_app_data (ctx);
  _2 = (long int) _1;
  b = (struct BIO *) _2;
  p = EVP_PKEY_CTX_get_keygen_info (ctx, 0);
  if (p == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  c = 46;

  <bb 4> :
  if (p == 1)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  c = 43;

  <bb 6> :
  if (p == 2)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  c = 42;

  <bb 8> :
  if (p == 3)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  c = 10;

  <bb 10> :
  BIO_write (b, &c, 1);
  BIO_flush (b);
  D.4179 = 1;
  c = {CLOBBER};
  return D.4179;

}



;; Function init_keygen_file (init_keygen_file, funcdef_no=27, decl_uid=3924, cgraph_uid=28, symbol_order=29)

;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
;; 2 succs { 3 4 }
;; 3 succs { 14 }
;; 4 succs { 5 6 }
;; 5 succs { 14 }
;; 6 succs { 7 8 }
;; 7 succs { 14 }
;; 8 succs { 9 10 }
;; 9 succs { 13 }
;; 10 succs { 11 12 }
;; 11 succs { 13 }
;; 12 succs { 14 }
;; 13 succs { 14 }
;; 14 succs { 1 }
int init_keygen_file (struct EVP_PKEY_CTX * * pctx, const char * file, struct ENGINE * e)
{
  struct EVP_PKEY_CTX * ctx;
  struct EVP_PKEY * pkey;
  struct BIO * pbio;
  int D.4184;

  <bb 2> :
  pkey = 0B;
  ctx = 0B;
  _1 = *pctx;
  if (_1 != 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  bio_err.40_2 = bio_err;
  BIO_puts (bio_err.40_2, "Parameters already set!\n");
  D.4184 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 14>; [INV]

  <bb 4> :
  _3 = BIO_new_file (file, "r");
  _4 = (long int) _3;
  pbio = (struct BIO *) _4;
  if (pbio == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  bio_err.41_5 = bio_err;
  BIO_printf (bio_err.41_5, "Can\'t open parameter file %s\n", file);
  D.4184 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 14>; [INV]

  <bb 6> :
  _6 = PEM_read_bio_Parameters (pbio, 0B);
  _7 = (long int) _6;
  pkey = (struct EVP_PKEY *) _7;
  BIO_free (pbio);
  if (pkey == 0B)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  bio_err.42_8 = bio_err;
  BIO_printf (bio_err.42_8, "Error reading parameter file %s\n", file);
  D.4184 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 14>; [INV]

  <bb 8> :
  ctx = EVP_PKEY_CTX_new (pkey, e);
  if (ctx == 0B)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  // predicted unlikely by goto predictor.
  goto <bb 13>; [INV]

  <bb 10> :
  _9 = EVP_PKEY_keygen_init (ctx);
  if (_9 <= 0)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  // predicted unlikely by goto predictor.
  goto <bb 13>; [INV]

  <bb 12> :
  EVP_PKEY_free (pkey);
  *pctx = ctx;
  D.4184 = 1;
  goto <bb 14>; [INV]

  <bb 13> :
err:
  bio_err.43_10 = bio_err;
  BIO_puts (bio_err.43_10, "Error initializing context\n");
  bio_err.44_11 = bio_err;
  ERR_print_errors (bio_err.44_11);
  EVP_PKEY_CTX_free (ctx);
  EVP_PKEY_free (pkey);
  D.4184 = 0;

  <bb 14> :
  return D.4184;

}



;; Function main (main, funcdef_no=30, decl_uid=4058, cgraph_uid=31, symbol_order=32)

Removing basic block 3
Merging blocks 2 and 4
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2
;; 2 succs { 1 }
int main (int argc, char * * argv)
{
  int D.4194;

  <bb 2> :
  genpkey_main (argc, argv);
  D.4194 = 0;
  return D.4194;

}


