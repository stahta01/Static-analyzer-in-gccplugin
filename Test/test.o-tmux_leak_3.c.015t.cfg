
;; Function server_client_get_path (server_client_get_path, funcdef_no=22, decl_uid=4052, cgraph_uid=23, symbol_order=22)

Merging blocks 7 and 8
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7
;; 2 succs { 3 4 }
;; 3 succs { 4 }
;; 4 succs { 5 6 }
;; 5 succs { 7 }
;; 6 succs { 7 }
;; 7 succs { 1 }
char * server_client_get_path (struct client * c, const char * file)
{
  char resolved[4096];
  char * path;
  char * D.4109;

  <bb 2> :
  _1 = *file;
  if (_1 == 47)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  path = strdup (file);

  <bb 4> :
  _2 = realpath (path, &resolved);
  if (_2 == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  D.4109 = path;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 7>; [INV]

  <bb 6> :
  free (path);
  D.4109 = strdup (&resolved);

  <bb 7> :
  resolved = {CLOBBER};
  return D.4109;

}



;; Function main (main, funcdef_no=25, decl_uid=4100, cgraph_uid=26, symbol_order=25)

Removing basic block 4
Merging blocks 2 and 3
Merging blocks 2 and 5
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2
;; 2 succs { 1 }
int main ()
{
  struct cmdq_item item;
  struct cmd self;
  int D.4112;

  <bb 2> :
  cmd_load_buffer_exec (&self, &item);
  cmd_save_buffer_exec (&self, &item);
  D.4112 = 0;
  self = {CLOBBER};
  item = {CLOBBER};
  return D.4112;

}



;; Function cmd_load_buffer_exec (cmd_load_buffer_exec, funcdef_no=23, decl_uid=4060, cgraph_uid=24, symbol_order=23)

Merging blocks 5 and 9
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11
;; 2 succs { 3 4 }
;; 3 succs { 11 }
;; 4 succs { 5 6 }
;; 5 succs { 9 10 }
;; 6 succs { 7 8 }
;; 7 succs { 8 }
;; 8 succs { 11 }
;; 9 succs { 10 }
;; 10 succs { 11 }
;; 11 succs { 1 }
cmd_retval cmd_load_buffer_exec (struct cmd * self, struct cmdq_item * item)
{
  int error;
  int ch;
  size_t psize;
  char * file;
  char * cause;
  char * new_pdata;
  char * pdata;
  const char * bufname;
  const char * path;
  struct FILE * f;
  struct client * c;
  struct cmd_load_buffer_data * cdata;
  struct args * args;
  cmd_retval D.4117;

  <bb 2> :
  args = self->args;
  c = item->client;
  bufname = 0B;
  _1 = args->argv;
  path = *_1;
  file = server_client_get_path (c, path);
  f = fopen (file, "rb");
  if (f == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  printf ("%s", file);
  free (file);
  D.4117 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 4> :
  pdata = 0B;
  psize = 0;
  _2 = ferror (f);
  if (_2 != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  printf ("%s: read error", file);
  // predicted unlikely by goto predictor.
  free (pdata);
  if (f != 0B)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 6> :
  if (pdata != 0B)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  _3 = pdata + psize;
  *_3 = 0;

  <bb 8> :
  fclose (f);
  free (file);
  D.4117 = 0;
  goto <bb 11>; [INV]

  <bb 9> :
  fclose (f);

  <bb 10> :
  D.4117 = -1;

  <bb 11> :
  return D.4117;

}



;; Function cmd_save_buffer_exec (cmd_save_buffer_exec, funcdef_no=24, decl_uid=4079, cgraph_uid=25, symbol_order=24)

Merging blocks 7 and 14
Merging blocks 8 and 15
;; 1 loops found
;;
;; Loop 0
;;  header 0, latch 1
;;  depth 0, outer -1
;;  nodes: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
;; 2 succs { 3 9 }
;; 3 succs { 4 5 }
;; 4 succs { 16 }
;; 5 succs { 7 6 }
;; 6 succs { 7 8 }
;; 7 succs { 16 }
;; 8 succs { 14 15 }
;; 9 succs { 10 11 }
;; 10 succs { 16 }
;; 11 succs { 12 13 }
;; 12 succs { 16 }
;; 13 succs { 16 }
;; 14 succs { 16 }
;; 15 succs { 16 }
;; 16 succs { 1 }
cmd_retval cmd_save_buffer_exec (struct cmd * self, struct cmdq_item * item)
{
  struct FILE * f;
  size_t bufsize;
  size_t msglen;
  size_t used;
  size_t size;
  char * file;
  char * msg;
  const char * flags;
  const char * end;
  const char * start;
  const char * bufdata;
  const char * bufname;
  const char * path;
  struct paste_buffer * pb;
  struct client * c;
  struct args * args;
  cmd_retval D.4129;

  <bb 2> :
  args = self->args;
  c = item->client;
  _1 = strcmp (path, "-");
  if (_1 == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 3> :
  if (c == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  D.4129 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 5> :
  _2 = c->session;
  if (_2 == 0B)
    goto <bb 7>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 6> :
  _3 = c->flags;
  _4 = _3 & 8192;
  if (_4 != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  // predicted unlikely by goto predictor.
  D.4129 = 0;
  goto <bb 16>; [INV]

  <bb 8> :
  // predicted unlikely by goto predictor.
  if (bufsize > 2499)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 9> :
  flags = "wb";
  file = server_client_get_path (c, path);
  f = fopen (file, flags);
  if (f == 0B)
    goto <bb 10>; [INV]
  else
    goto <bb 11>; [INV]

  <bb 10> :
  printf ("%s", file);
  free (file);
  D.4129 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 11> :
  _5 = fwrite (bufdata, 1, bufsize, f);
  if (bufsize != _5)
    goto <bb 12>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 12> :
  printf ("%s: write error", file);
  fclose (f);
  D.4129 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 13> :
  fclose (f);
  free (file);
  D.4129 = 0;
  goto <bb 16>; [INV]

  <bb 14> :
  D.4129 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 15> :
  msg = 0B;
  used = 0;
  free (msg);
  D.4129 = 0;

  <bb 16> :
  return D.4129;

}


